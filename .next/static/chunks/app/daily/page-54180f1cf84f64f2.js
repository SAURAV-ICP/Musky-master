(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[379],{8924:function(){},5024:function(){},3217:function(e,a,t){Promise.resolve().then(t.bind(t,8461))},8461:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return u}});var l=t(3827),n=t(4090),s=t(1840),r=t(963),i=t(5036),o=t(6790),c=t(4958);let d=[{day:1,amount:100,label:"Day 1"},{day:2,amount:200,label:"Day 2"},{day:3,amount:300,label:"Day 3"},{day:4,amount:400,label:"Day 4"},{day:5,amount:500,label:"Day 5"},{day:6,amount:750,label:"Day 6"},{day:7,amount:1e3,label:"Day 7 - Weekly Bonus!"},{day:8,amount:500,label:"Day 8"},{day:9,amount:600,label:"Day 9"},{day:10,amount:700,label:"Day 10"},{day:11,amount:800,label:"Day 11"},{day:12,amount:900,label:"Day 12"},{day:13,amount:1e3,label:"Day 13"},{day:14,amount:2e3,label:"Day 14 - Bi-weekly Bonus!"},{day:15,amount:1e3,label:"Day 15"},{day:16,amount:1100,label:"Day 16"},{day:17,amount:1200,label:"Day 17"},{day:18,amount:1300,label:"Day 18"},{day:19,amount:1400,label:"Day 19"},{day:20,amount:1500,label:"Day 20"},{day:21,amount:3e3,label:"Day 21 - Triple Week Bonus!"},{day:22,amount:1500,label:"Day 22"},{day:23,amount:1600,label:"Day 23"},{day:24,amount:1700,label:"Day 24"},{day:25,amount:1800,label:"Day 25"},{day:26,amount:1900,label:"Day 26"},{day:27,amount:2e3,label:"Day 27"},{day:28,amount:5e3,label:"Day 28 - Monthly Bonus!"},{day:29,amount:2e3,label:"Day 29"},{day:30,amount:2500,label:"Day 30 - Monthly Finale!"}],m=e=>{if(e<=30)return d[e-1];let a=Math.floor((e-1)/30),t=(e-1)%30+1,l=d[t-1];return{day:t,amount:Math.floor(l.amount*(1+.1*a)),label:l.label+" (Cycle ".concat(a+1,")")}};function u(){let{user:e,loading:a,mutate:t}=(0,o.a)(),[u,x]=(0,n.useState)(0),[b,y]=(0,n.useState)(null),[h,f]=(0,n.useState)(""),[g,p]=(0,n.useState)(!1),[j,w]=(0,n.useState)(!1),[N,v]=(0,n.useState)(!1),[D,_]=(0,n.useState)(0);(0,n.useEffect)(()=>{(null==e?void 0:e.user_id)&&S()},[e]),(0,n.useEffect)(()=>{let e=setInterval(()=>{k()},1e3);return()=>clearInterval(e)},[e]);let S=async()=>{if(null==e?void 0:e.user_id)try{let{data:a,error:t}=await c.O.from("daily_claims").select("*").eq("user_id",e.user_id).single();if(t){if("PGRST116"===t.code){let{data:a,error:t}=await c.O.from("daily_claims").insert({user_id:e.user_id,current_streak:0,last_claim_date:null,total_claims:0}).select().single();if(t)throw t;x(0),y(m(1)),p(!0);return}throw t}let l=a.last_claim_date?new Date(a.last_claim_date):null,n=new Date;if(l){let e=new Date(l.setHours(0,0,0,0)),t=(new Date(n.setHours(0,0,0,0)).getTime()-e.getTime())/864e5;if(0===t){x(a.current_streak),y(m(a.current_streak+1)),p(!1);let e=new Date;e.setDate(e.getDate()+1),e.setHours(0,0,0,0),k(e)}else 1===t?(x(a.current_streak),y(m(a.current_streak+1))):(x(0),y(m(1))),p(!0)}else x(0),y(m(1)),p(!0)}catch(e){console.error("Error fetching daily claim data:",e),r.Am.error("Failed to load daily claim data")}},k=e=>{if(!g){let a=new Date,t=(e||new Date(a.getFullYear(),a.getMonth(),a.getDate()+1)).getTime()-a.getTime();if(t<=0){p(!0),f("");return}f("".concat(Math.floor(t/36e5).toString().padStart(2,"0"),":").concat(Math.floor(t%36e5/6e4).toString().padStart(2,"0"),":").concat(Math.floor(t%6e4/1e3).toString().padStart(2,"0")))}},M=async()=>{if((null==e?void 0:e.user_id)&&g&&b){w(!0);try{let{data:a,error:l}=await c.O.from("daily_claims").select("*").eq("user_id",e.user_id).single();if(l&&"PGRST116"!==l.code)throw l;let n=new Date,s=a?a.current_streak+1:1,r=m(s),{error:i}=await c.O.from("daily_claims").upsert({user_id:e.user_id,current_streak:s,last_claim_date:n.toISOString(),total_claims:((null==a?void 0:a.total_claims)||0)+1});if(i)throw i;let{error:o}=await c.O.from("users").update({balance:e.balance+r.amount}).eq("user_id",e.user_id);if(o)throw o;_(r.amount),v(!0),x(s),y(m(s+1)),p(!1);let d=new Date;d.setDate(d.getDate()+1),d.setHours(0,0,0,0),k(d),await t(),setTimeout(()=>{v(!1)},3e3)}catch(e){console.error("Error claiming daily reward:",e),r.Am.error("Failed to claim daily reward")}finally{w(!1)}}},C=e=>e.toLocaleString(void 0,{maximumFractionDigits:0});return a?(0,l.jsx)(i.Z,{children:(0,l.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,l.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-accent"})})})}):(0,l.jsx)(i.Z,{children:(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"Daily Rewards"}),(0,l.jsx)("p",{className:"text-white/60",children:"Claim MUSKY tokens every day to build your streak"})]}),(0,l.jsxs)("div",{className:"bg-primary-dark p-3 rounded-xl",children:[(0,l.jsx)("p",{className:"text-sm text-white/60",children:"Your Balance"}),(0,l.jsxs)("p",{className:"text-xl font-bold",children:[C((null==e?void 0:e.balance)||0)," MUSKY"]})]})]}),(0,l.jsx)("div",{className:"bg-primary-dark rounded-xl p-6 mb-8",children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[(0,l.jsxs)("div",{className:"mb-4 md:mb-0",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Current Streak"}),(0,l.jsxs)("div",{className:"flex items-baseline",children:[(0,l.jsx)("span",{className:"text-4xl font-bold text-accent",children:u}),(0,l.jsx)("span",{className:"text-white/60 ml-2",children:"days"})]}),u>0&&(0,l.jsx)("p",{className:"text-sm text-white/60 mt-1",children:"Keep your streak going by claiming daily!"})]}),(0,l.jsx)("div",{className:"text-center",children:g?(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-white/60 mb-2",children:"Today's Reward"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-green-400 mb-3",children:[b?C(b.amount):0," MUSKY"]}),(0,l.jsx)(s.E.button,{className:"px-6 py-3 bg-accent hover:bg-accent/80 rounded-lg font-bold",whileHover:{scale:1.05},whileTap:{scale:.95},disabled:j,onClick:M,children:j?(0,l.jsxs)("span",{className:"flex items-center justify-center",children:[(0,l.jsx)("span",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Claiming..."]}):"Claim Reward"})]}):(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-white/60 mb-2",children:"Next Reward Available In"}),(0,l.jsx)("p",{className:"text-2xl font-bold mb-3",children:h}),(0,l.jsx)("p",{className:"text-sm text-white/60",children:"Come back tomorrow!"})]})})]})}),(0,l.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Upcoming Rewards"}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-8",children:Array.from({length:5}).map((e,a)=>{let t=m(u+a+1),n=0===a;return(0,l.jsxs)("div",{className:"bg-primary-dark rounded-xl p-4 ".concat(n?"border-2 border-accent":""),children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,l.jsx)("span",{className:"text-sm text-white/60",children:t.label}),n&&(0,l.jsx)("span",{className:"bg-accent/20 text-accent text-xs px-2 py-1 rounded-full",children:"Next"})]}),(0,l.jsxs)("p",{className:"text-xl font-bold",children:[C(t.amount)," MUSKY"]})]},a)})}),(0,l.jsx)("h2",{className:"text-xl font-bold mb-4",children:"30-Day Reward Calendar"}),(0,l.jsx)("div",{className:"bg-primary-dark rounded-xl p-6 overflow-x-auto",children:(0,l.jsx)("div",{className:"grid grid-cols-7 gap-3 min-w-[700px]",children:d.map((e,a)=>{let t=e.day<=u,n=e.day===u+1,s=e.day%7==0;return(0,l.jsxs)("div",{className:"p-3 rounded-lg ".concat(t?"bg-green-500/20 border border-green-500/30":n?"bg-accent/20 border-2 border-accent":s?"bg-orange-500/20 border border-orange-500/30":"bg-black/20"),children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsxs)("span",{className:"text-xs ".concat(t?"text-green-400":n?"text-accent":"text-white/60"),children:["Day ",e.day]}),t&&(0,l.jsx)("span",{className:"text-xs bg-green-500/30 text-green-400 px-1.5 py-0.5 rounded-full",children:"Claimed"})]}),(0,l.jsx)("p",{className:"font-bold ".concat(t?"text-green-400":n?"text-accent":s?"text-orange-400":"text-white"),children:C(e.amount)})]},a)})})}),N&&(0,l.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:(0,l.jsxs)(s.E.div,{initial:{scale:.5,opacity:0},animate:{scale:[.5,1.2,1],opacity:[0,1,1,0],y:[0,-50,-100]},transition:{duration:3,times:[0,.3,.8,1]},className:"text-4xl font-bold text-green-400 bg-black/50 px-6 py-3 rounded-xl backdrop-blur-sm",children:["+",C(D)," MUSKY"]})})]})})}},5036:function(e,a,t){"use strict";t.d(a,{Z:function(){return d}});var l=t(3827),n=t(4090),s=t(6790),r=t(1348),i=t(1840);function o(e){let{minBalance:a=1e3,onClose:t}=e,{user:o}=(0,s.a)(),[c,d]=(0,n.useState)(null),[m,u]=(0,n.useState)(!0);(0,n.useEffect)(()=>{if(!o||o.balance<a){u(!1);return}x()},[o,a]);let x=async()=>{try{let e=await fetch("/api/admin/broadcast/active");if(e.ok){let a=await e.json();a.message?d(a.message):d({id:"default",title:"Your MUSKY Balance",content:"You have ".concat(null==o?void 0:o.balance," MUSKY tokens! Consider staking them to earn more rewards."),type:"info",active:!0,created_at:new Date().toISOString(),expires_at:null})}else d({id:"default",title:"Welcome to MUSKY",content:"Start earning and staking your MUSKY tokens today!",type:"info",active:!0,created_at:new Date().toISOString(),expires_at:null})}catch(e){console.error("Error fetching broadcast message:",e),d({id:"default",title:"Welcome to MUSKY",content:"Start earning and staking your MUSKY tokens today!",type:"info",active:!0,created_at:new Date().toISOString(),expires_at:null})}},b=()=>{u(!1),t&&t()};return m&&c?(0,l.jsx)(r.M,{children:(0,l.jsx)(i.E.div,{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b,children:(0,l.jsxs)(i.E.div,{className:"bg-gradient-to-br from-blue-800 to-blue-900 rounded-xl shadow-2xl p-6 max-w-md w-full",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-white",children:c.title}),(0,l.jsx)("button",{onClick:b,className:"text-gray-300 hover:text-white transition-colors",children:"✕"})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("p",{className:"text-gray-200 mb-2",children:c.content}),o&&(0,l.jsx)("div",{className:"bg-blue-700 bg-opacity-30 rounded-lg p-3 mt-3",children:(0,l.jsxs)("p",{className:"text-white font-medium",children:["Current Balance: ",(0,l.jsxs)("span",{className:"font-bold",children:[o.balance," MUSKY"]})]})})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,l.jsx)("button",{onClick:b,className:"px-4 py-2 rounded-lg bg-blue-700 text-white hover:bg-blue-600 transition-colors",children:"Close"}),(0,l.jsx)("button",{onClick:()=>{window.location.href="/staking",b()},className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-500 transition-colors",children:"Stake Now"})]})]})})}):null}var c=t(1116);function d(e){let{children:a}=e,{user:t,loading:r}=(0,s.a)(),[i,d]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(t&&!r){let e=localStorage.getItem("last_balance_popup_time"),a=new Date().getTime();(!e||a-parseInt(e)>864e5)&&(d(!0),localStorage.setItem("last_balance_popup_time",a.toString()))}},[t,r]),(0,l.jsx)(c.LD,{manifestUrl:"/tonconnect-manifest.json",children:(0,l.jsxs)("div",{className:"flex flex-col min-h-screen bg-gradient-to-b from-blue-900 to-blue-950",children:[(0,l.jsx)("main",{className:"flex-grow container mx-auto px-4 py-8",children:a}),i&&t&&(0,l.jsx)(o,{minBalance:1e3,onClose:()=>{d(!1)}})]})})}}},function(e){e.O(0,[896,840,965,522,548,971,69,744],function(){return e(e.s=3217)}),_N_E=e.O()}]);