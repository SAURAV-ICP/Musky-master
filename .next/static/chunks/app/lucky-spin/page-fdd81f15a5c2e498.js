(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[494],{189:function(e,t,a){Promise.resolve().then(a.bind(a,1265))},1265:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var s=a(3827),n=a(4090),l=a(7372),i=a(1840),r=a(1348),c=a(6790),o=a(963),d=a(8792);let u=Math.floor(100);function m(){var e;let{user:t,mutate:a}=(0,c.a)(),[m,h]=(0,n.useState)(!1),[x,p]=(0,n.useState)(0),[f,b]=(0,n.useState)(null),[j,y]=(0,n.useState)(null),[v,g]=(0,n.useState)(0),[w,N]=(0,n.useState)(null),[k,E]=(0,n.useState)(!1),[S,_]=(0,n.useState)(1e3);(0,n.useEffect)(()=>{if(console.log("Current user data:",t),(null==t?void 0:t.spin_energy)||(console.log("No spin energy found, attempting to initialize..."),a()),(null==t?void 0:t.spin_energy)&&g(t.spin_energy),(null==t?void 0:t.last_spin_energy_reset)&&!(null==t?void 0:t.is_admin)){let e=()=>{let e=new Date,s=new Date(new Date(t.last_spin_energy_reset).getTime()+432e5);if(e>=s){N(null),a();return}let n=s.getTime()-e.getTime();N("".concat(Math.floor(n/36e5),"h ").concat(Math.floor(n%36e5/6e4),"m"))};e();let s=setInterval(e,6e4);return()=>clearInterval(s)}},[t]);let C=[{type:"SOL",amount:1,chance:"0.1%",color:"#00ff00",emoji:"\uD83D\uDC8E"},{type:"SOL",amount:.5,chance:"0.5%",color:"#00cc00",emoji:"\uD83C\uDF1F"},{type:"MUSKY",amount:5e3,chance:"1%",color:"#0099ff",emoji:"\uD83D\uDE80"},{type:"MUSKY",amount:2e3,chance:"3%",color:"#3366ff",emoji:"\uD83D\uDCAB"},{type:"MUSKY",amount:1e3,chance:"5%",color:"#6633ff",emoji:"✨"},{type:"Energy",amount:500,chance:"10%",color:"#9933ff",emoji:"⚡"},{type:"MUSKY",amount:500,chance:"80.4%",color:"#cc33ff",emoji:"\uD83D\uDCB0"}],D=async()=>{if((null==t?void 0:t.user_id)&&!m)try{h(!0),p(x+(1800+360*Math.random()));let e=await fetch("/api/lucky-spin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:t.user_id})}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to spin");setTimeout(()=>{b(s.prize),h(!1),a()},3e3),s.next_reset&&y(s.next_reset)}catch(e){h(!1),o.ZP.error(e instanceof Error?e.message:"Failed to spin")}};return(0,s.jsx)(l.Z,{children:(0,s.jsxs)("div",{className:"min-h-screen p-4 flex flex-col items-center justify-start pt-8 relative",children:[(0,s.jsx)(d.default,{href:"/",className:"absolute top-4 right-4",children:(0,s.jsx)(i.E.button,{className:"w-10 h-10 rounded-full bg-accent/20 flex items-center justify-center text-xl hover:bg-accent/40",whileHover:{scale:1.1},whileTap:{scale:.9},children:"✕"})}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-center mb-8 text-white",children:"Lucky Spin"}),(0,s.jsxs)(i.E.button,{className:"absolute top-4 left-4 px-4 py-2 bg-accent/20 rounded-full flex items-center space-x-2 hover:bg-accent/40",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>E(!0),children:[(0,s.jsx)(i.E.span,{animate:{scale:[1,1.2,1],opacity:[1,.8,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"⚡"}),(0,s.jsx)("span",{className:"font-semibold",children:(null==t?void 0:t.spin_energy)||0})]}),(0,s.jsxs)("div",{className:"w-full max-w-md mb-8 bg-primary/20 backdrop-blur-lg rounded-xl p-6 border border-white/10",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-2 mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(i.E.span,{className:"text-xl mr-2",animate:{scale:[1,1.2,1],opacity:[1,.8,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"⚡"}),(0,s.jsx)("span",{className:"text-sm font-semibold text-white/80",children:"Stamina"})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("span",{className:"text-sm font-bold",children:[v,"/",(null==t?void 0:t.is_admin)?"∞":1200]}),!(null==t?void 0:t.is_admin)&&(0,s.jsxs)("div",{className:"text-xs text-white/60",children:["+",u,"/hour"]})]})]}),(0,s.jsx)("div",{className:"w-full h-3 bg-black/20 rounded-full overflow-hidden p-0.5",children:(0,s.jsx)(i.E.div,{className:"h-full bg-yellow-400 rounded-full relative overflow-hidden",initial:{width:"0%"},animate:{width:(null==t?void 0:t.is_admin)?"100%":"".concat(v/1200*100,"%")},transition:{duration:.5},children:(0,s.jsx)(i.E.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:1.5,repeat:1/0,ease:"linear"}})})}),w&&!(null==t?void 0:t.is_admin)&&(0,s.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,s.jsxs)("p",{className:"text-sm text-white/60",children:["Next reset in: ",w]}),(0,s.jsxs)("p",{className:"text-sm text-accent",children:["+",u," stamina/hr"]})]})]}),(0,s.jsxs)("div",{className:"relative w-80 h-80 mb-8",children:[(0,s.jsx)(i.E.div,{className:"w-full h-full rounded-full border-4 border-accent relative overflow-hidden bg-black/30",style:{transform:"rotate(".concat(x,"deg)")},transition:{duration:3,ease:"easeOut"},children:C.map((e,t)=>(0,s.jsxs)("div",{className:"absolute w-full h-full",style:{transform:"rotate(".concat(360*t/C.length,"deg)"),transformOrigin:"50% 50%"},children:[(0,s.jsx)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-1 h-1/2 origin-bottom",style:{backgroundColor:e.color}}),(0,s.jsx)("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 text-2xl",children:e.emoji})]},t))}),(0,s.jsx)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-4 h-8 bg-accent",style:{clipPath:"polygon(50% 0, 100% 100%, 0 100%)"}})]}),(0,s.jsx)(i.E.button,{className:"px-8 py-3 rounded-xl font-bold text-lg mb-8 ".concat(m||v<1e3?"bg-gray-500 cursor-not-allowed":"bg-accent hover:bg-accent/80"),whileHover:!m&&v>=1e3?{scale:1.05}:{},whileTap:!m&&v>=1e3?{scale:.95}:{},onClick:D,disabled:m||v<1e3,children:m?"Spinning...":"SPIN"}),(0,s.jsxs)("div",{className:"w-full max-w-md bg-black/20 rounded-xl p-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-white",children:"Prize Pool"}),(0,s.jsx)("div",{className:"space-y-2",children:C.map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between items-center text-white/80",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{children:e.emoji}),(0,s.jsxs)("span",{children:[e.amount," ",e.type]})]}),(0,s.jsx)("span",{className:"text-accent",children:e.chance})]},t))})]}),(0,s.jsx)(r.M,{children:f&&!m&&(0,s.jsx)(i.E.div,{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>b(null),children:(0,s.jsxs)(i.E.div,{className:"bg-primary p-8 rounded-2xl text-center",initial:{scale:0},animate:{scale:1},exit:{scale:0},onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:(null===(e=C.find(e=>e.type.toLowerCase()===f.type&&e.amount===f.amount))||void 0===e?void 0:e.emoji)||"\uD83C\uDF89"}),(0,s.jsx)("h3",{className:"text-2xl font-bold mb-2",children:"Congratulations!"}),(0,s.jsxs)("p",{className:"text-lg",children:["You won ",f.amount," ",f.type.toUpperCase(),"!"]}),(0,s.jsx)(i.E.button,{className:"mt-4 px-6 py-2 bg-accent rounded-full font-bold",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>b(null),children:"Awesome!"})]})})}),(0,s.jsx)(r.M,{children:k&&(0,s.jsx)(i.E.div,{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>E(!1),children:(0,s.jsxs)(i.E.div,{className:"bg-primary/90 backdrop-blur-xl rounded-2xl w-full max-w-md p-6",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Purchase Stamina"}),(0,s.jsx)("button",{onClick:()=>E(!1),children:"✕"})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-white/60 mb-2",children:"Amount (1000-10000)"}),(0,s.jsx)("input",{type:"range",min:"1000",max:"10000",step:"1000",value:S,onChange:e=>_(parseInt(e.target.value)),className:"w-full h-2 bg-accent/20 rounded-full appearance-none cursor-pointer"}),(0,s.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,s.jsxs)("span",{children:[S," Stamina"]}),(0,s.jsxs)("span",{children:[Math.floor(S/10)," Stars"]})]})]}),(0,s.jsx)(i.E.button,{className:"w-full py-3 bg-accent rounded-xl font-bold",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:async()=>{try{if(!(await fetch("/api/stamina/purchase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:null==t?void 0:t.user_id,amount:S,cost:Math.floor(S/10)})})).ok)throw Error("Purchase failed");o.ZP.success("Stamina purchased successfully!"),a(),E(!1)}catch(e){o.ZP.error("Failed to purchase stamina")}},children:"Purchase"})]})]})})})]})})}},7372:function(e,t,a){"use strict";a.d(t,{Z:function(){return c}});var s=a(3827);a(4090);var n=a(8792),l=a(703),i=a(1840),r=a(7907);function c(e){let{children:t}=e,a=(0,r.usePathname)(),c=[{href:"/",label:"Home",icon:"\uD83C\uDFE0"},{href:"/tasks",label:"Tasks",icon:(0,s.jsx)(l.default,{src:"/components/assets/TASKS.png",width:24,height:24,alt:"Tasks"})},{href:"/mining",label:"Mining",icon:"⛏️"},{href:"/refer",label:"Refer",icon:"\uD83D\uDC65"},{href:"/earn",label:"Earn",icon:"\uD83D\uDCB0"}];return(0,s.jsx)("div",{className:"min-h-screen",children:(0,s.jsxs)(i.E.div,{className:"min-h-screen bg-gradient-to-b from-background-start-rgb to-background-end-rgb",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,s.jsx)("main",{className:"container mx-auto px-4 py-8 pb-20",children:(0,s.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:t})}),(0,s.jsx)(i.E.nav,{className:"fixed bottom-0 left-0 right-0 bg-white/10 backdrop-blur-lg border-t border-white/20",initial:{y:100},animate:{y:0},transition:{duration:.5},children:(0,s.jsx)("div",{className:"container mx-auto px-4",children:(0,s.jsx)("div",{className:"flex justify-between items-center py-2",children:c.map(e=>(0,s.jsxs)(n.default,{href:e.href,className:"relative flex flex-col items-center p-2 group",children:[(0,s.jsx)(i.E.span,{className:"text-2xl transition-transform duration-200 ".concat(a===e.href?"scale-110":"scale-100"),whileHover:{scale:1.1},whileTap:{scale:.9},children:e.icon}),(0,s.jsx)("span",{className:"text-xs mt-1 ".concat(a===e.href?"text-white font-bold":"text-white/60"),children:e.label}),a===e.href&&(0,s.jsx)(i.E.div,{className:"absolute -bottom-2 w-12 h-1 bg-accent rounded-full",layoutId:"activeTab",transition:{type:"spring",bounce:.2}})]},e.href))})})})]})})}}},function(e){e.O(0,[840,965,134,548,971,69,744],function(){return e(e.s=189)}),_N_E=e.O()}]);