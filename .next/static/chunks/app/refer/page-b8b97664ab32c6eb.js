(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[390],{9266:function(e,r,s){Promise.resolve().then(s.bind(s,9267))},9267:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return o}});var n=s(3827),t=s(4090),a=s(1840),l=s(963),i=s(6790),c=s(7372);function o(){let{user:e}=(0,i.a)(),[r,s]=(0,t.useState)(null),[o,d]=(0,t.useState)(!0),u="https://t.me/MUSKY_ON_SOL_BOT";(0,t.useEffect)(()=>{(null==e?void 0:e.user_id)&&h()},[null==e?void 0:e.user_id]);let h=async()=>{if(null==e?void 0:e.user_id)try{d(!0);let r=await fetch("/api/referrals/".concat(e.user_id));if(r.ok){let n=await r.json();n.referralLink="".concat(u,"?start=ref_").concat(e.user_id),s(n)}else throw Error("Failed to fetch referral stats")}catch(e){console.error("Error fetching referral stats:",e),l.Am.error("Failed to load referral data")}finally{d(!1)}};return(0,n.jsx)(c.Z,{children:(0,n.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Refer & Earn"}),o?(0,n.jsx)("div",{className:"flex justify-center py-12",children:(0,n.jsxs)("div",{className:"animate-pulse flex space-x-2",children:[(0,n.jsx)("div",{className:"h-3 w-3 bg-accent rounded-full"}),(0,n.jsx)("div",{className:"h-3 w-3 bg-accent rounded-full"}),(0,n.jsx)("div",{className:"h-3 w-3 bg-accent rounded-full"})]})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"bg-primary/20 rounded-xl p-6 mb-6 border border-white/10",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,n.jsxs)("div",{className:"bg-background/30 p-4 rounded-lg text-center",children:[(0,n.jsx)("p",{className:"text-white/60 text-sm mb-1",children:"Total Referrals"}),(0,n.jsx)("p",{className:"text-2xl font-bold",children:(null==r?void 0:r.totalReferrals)||0})]}),(0,n.jsxs)("div",{className:"bg-background/30 p-4 rounded-lg text-center",children:[(0,n.jsx)("p",{className:"text-white/60 text-sm mb-1",children:"Total Earned"}),(0,n.jsxs)("p",{className:"text-2xl font-bold",children:[(null==r?void 0:r.totalEarned)||0," MUSKY"]})]})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("p",{className:"text-white/60 text-sm mb-2",children:"Your Referral Link"}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"text",value:(null==r?void 0:r.referralLink)||"",readOnly:!0,className:"flex-1 bg-background/50 border border-white/10 rounded-l-lg py-2 px-3 text-sm"}),(0,n.jsx)(a.E.button,{className:"bg-accent py-2 px-4 rounded-r-lg text-sm font-medium",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{(null==r?void 0:r.referralLink)&&navigator.clipboard.writeText(r.referralLink).then(()=>{l.Am.success("Referral link copied to clipboard!")}).catch(()=>{l.Am.error("Failed to copy link")})},children:"Copy"})]})]}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsxs)(a.E.button,{className:"flex-1 bg-primary/40 py-3 rounded-lg font-medium flex items-center justify-center space-x-2",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{if(!(null==r?void 0:r.referralLink))return;let e="https://t.me/share/url?url=".concat(encodeURIComponent(r.referralLink),"&text=").concat(encodeURIComponent("Join me on Musky and earn MUSKY tokens! Use my referral link:"));window.open(e,"_blank")},children:[(0,n.jsx)("span",{children:"\uD83D\uDCF1"}),(0,n.jsx)("span",{children:"Share on Telegram"})]}),(0,n.jsxs)(a.E.button,{className:"flex-1 bg-accent/80 py-3 rounded-lg font-medium flex items-center justify-center space-x-2",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{if(!(null==e?void 0:e.user_id))return;let r="".concat(u,"?start=ref_").concat(e.user_id);window.open(r,"_blank")},children:[(0,n.jsx)("span",{children:"\uD83E\uDD16"}),(0,n.jsx)("span",{children:"Open Bot"})]})]})]}),(0,n.jsxs)("div",{className:"bg-primary/20 rounded-xl p-6 border border-white/10",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4",children:"How It Works"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"w-8 h-8 bg-accent/20 rounded-full flex items-center justify-center flex-shrink-0",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:"Share your referral link"}),(0,n.jsx)("p",{className:"text-white/60 text-sm",children:"Send your unique referral link to friends via Telegram"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"w-8 h-8 bg-accent/20 rounded-full flex items-center justify-center flex-shrink-0",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:"Friends join $Musky platform"}),(0,n.jsx)("p",{className:"text-white/60 text-sm",children:"When they join using your link, they become your referral, you Get instantly 2000 $MUSKY"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"w-8 h-8 bg-accent/20 rounded-full flex items-center justify-center flex-shrink-0",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:"Earn Additional rewards"}),(0,n.jsx)("p",{className:"text-white/60 text-sm",children:"Get 10% of all MUSKY your referrals earn"})]})]})]})]}),(null==r?void 0:r.recentReferrals)&&r.recentReferrals.length>0&&(0,n.jsxs)("div",{className:"bg-primary/20 rounded-xl p-6 mt-6 border border-white/10",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Recent Referrals"}),(0,n.jsx)("div",{className:"space-y-3",children:r.recentReferrals.map((e,r)=>(0,n.jsxs)("div",{className:"bg-background/30 p-3 rounded-lg flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium",children:e.username}),(0,n.jsx)("p",{className:"text-white/60 text-xs",children:e.date})]}),(0,n.jsx)("div",{className:"text-right",children:(0,n.jsxs)("p",{className:"font-bold text-accent",children:["+",e.earned," MUSKY"]})})]},r))})]})]})]})})}},7372:function(e,r,s){"use strict";s.d(r,{Z:function(){return c}});var n=s(3827);s(4090);var t=s(8792),a=s(703),l=s(1840),i=s(7907);function c(e){let{children:r}=e,s=(0,i.usePathname)(),c=[{href:"/",label:"Home",icon:"\uD83C\uDFE0"},{href:"/tasks",label:"Tasks",icon:(0,n.jsx)(a.default,{src:"/components/assets/TASKS.png",width:24,height:24,alt:"Tasks"})},{href:"/mining",label:"Mining",icon:"⛏️"},{href:"/refer",label:"Refer",icon:"\uD83D\uDC65"},{href:"/earn",label:"Earn",icon:"\uD83D\uDCB0"}];return(0,n.jsx)("div",{className:"min-h-screen",children:(0,n.jsxs)(l.E.div,{className:"min-h-screen bg-gradient-to-b from-background-start-rgb to-background-end-rgb",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,n.jsx)("main",{className:"container mx-auto px-4 py-8 pb-20",children:(0,n.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:r})}),(0,n.jsx)(l.E.nav,{className:"fixed bottom-0 left-0 right-0 bg-white/10 backdrop-blur-lg border-t border-white/20",initial:{y:100},animate:{y:0},transition:{duration:.5},children:(0,n.jsx)("div",{className:"container mx-auto px-4",children:(0,n.jsx)("div",{className:"flex justify-between items-center py-2",children:c.map(e=>(0,n.jsxs)(t.default,{href:e.href,className:"relative flex flex-col items-center p-2 group",children:[(0,n.jsx)(l.E.span,{className:"text-2xl transition-transform duration-200 ".concat(s===e.href?"scale-110":"scale-100"),whileHover:{scale:1.1},whileTap:{scale:.9},children:e.icon}),(0,n.jsx)("span",{className:"text-xs mt-1 ".concat(s===e.href?"text-white font-bold":"text-white/60"),children:e.label}),s===e.href&&(0,n.jsx)(l.E.div,{className:"absolute -bottom-2 w-12 h-1 bg-accent rounded-full",layoutId:"activeTab",transition:{type:"spring",bounce:.2}})]},e.href))})})})]})})}},6790:function(e,r,s){"use strict";s.d(r,{a:function(){return d},d:function(){return o}});var n=s(3827),t=s(4090),a=s(7212),l=s(4958);let i=(0,t.createContext)({user:null,loading:!1,error:null,mutate:async()=>{}}),c="12345";function o(e){let{children:r}=e,{data:s,error:t,isLoading:o,mutate:d}=(0,a.ZP)("user",async()=>{try{console.log("Fetching user data...");let{data:e,error:r}=await l.O.from("users").select("*").eq("user_id",c).single();if(console.log("Existing user data:",e),console.log("Fetch error:",r),r){if("PGRST116"===r.code){console.log("User not found, creating new user...");let{data:e,error:r}=await l.O.from("users").insert({user_id:c,balance:0,solana_balance:0,energy:1200,spin_energy:1200,last_spin_energy_reset:new Date().toISOString(),level:"1",is_admin:!1}).select().single();if(r)throw console.error("Error creating new user:",r),r;return console.log("New user created:",e),e}throw r}if(e&&(void 0===e.spin_energy||null===e.spin_energy||0===e.spin_energy)){console.log("Updating user with spin energy...");let{data:e,error:r}=await l.O.from("users").update({spin_energy:1200,last_spin_energy_reset:new Date().toISOString()}).eq("user_id",c).select().single();if(r)throw console.error("Error updating user:",r),r;return console.log("User updated with spin energy:",e),e}if(e.last_spin_energy_reset){let r=new Date(e.last_spin_energy_reset),s=new Date;if((s.getTime()-r.getTime())/36e5>=12){console.log("Resetting spin energy after 12 hours...");let{data:e,error:r}=await l.O.from("users").update({spin_energy:1200,last_spin_energy_reset:s.toISOString()}).eq("user_id",c).select().single();if(r)throw console.error("Error resetting energy:",r),r;return console.log("Energy reset complete:",e),e}}return e}catch(e){throw console.error("Error in user context:",e),e}});return(0,n.jsx)(i.Provider,{value:{user:s,loading:o,error:t,mutate:d},children:r})}function d(){return(0,t.useContext)(i)}},4958:function(e,r,s){"use strict";s.d(r,{O:function(){return l}});var n=s(9377);let t="https://pkaooixolhnhdyajwlgw.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrYW9vaXhvbGhuaGR5YWp3bGd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk5NDQzMDEsImV4cCI6MjA1NTUyMDMwMX0.ATOLcUZaP--eojDV0ugG0bujlOkzam0q7A6e9IIKnxY";if(!t||!a)throw Error("Missing Supabase credentials");let l=(0,n.eI)(t,a)}},function(e){e.O(0,[414,965,971,69,744],function(){return e(e.s=9266)}),_N_E=e.O()}]);