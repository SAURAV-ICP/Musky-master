(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{307:function(e,t,a){Promise.resolve().then(a.bind(a,741))},741:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var s=a(3827),i=a(4090),r=a(7372),l=a(1840),n=a(6790),c=a(963),o=a(7907),d=a(4958),m=a(1348),h=e=>{let{notifications:t,onDismiss:a}=e;return(0,s.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:(0,s.jsx)(m.M,{children:t.map(e=>(0,s.jsx)(l.E.div,{initial:{opacity:0,x:100,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.9},className:"bg-black/80 backdrop-blur-lg rounded-lg p-4 shadow-lg border border-white/10 w-80 ".concat("success"===e.type?"border-green-500/50":"error"===e.type?"border-red-500/50":"border-white/10"),children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-xl\n                ".concat("success"===e.type?"bg-green-500/20 text-green-400":"error"===e.type?"bg-red-500/20 text-red-400":"bg-primary/30 text-white"),children:"success"===e.type?"✓":"error"===e.type?"✕":"ℹ"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm ".concat("success"===e.type?"text-green-400":"error"===e.type?"text-red-400":"text-white/90"),children:e.message}),e.amount&&"success"===e.type&&(0,s.jsxs)(l.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center space-x-2 mt-1",children:[(0,s.jsx)("span",{className:"text-xs text-white/60",children:"Reward:"}),(0,s.jsxs)(l.E.span,{className:"text-sm font-bold text-green-400",initial:{scale:1},animate:{scale:[1,1.2,1]},transition:{duration:.5},children:["+",e.amount," MUSKY"]})]})]}),(0,s.jsx)("button",{onClick:()=>a(e.id),className:"text-white/60 hover:text-white",children:"✕"})]})},e.id))})})},x=a(703);function u(){let{user:e}=(0,n.a)(),[t,a]=(0,i.useState)([]),[m,u]=(0,i.useState)([]),[p,b]=(0,i.useState)([]),[f,g]=(0,i.useState)({}),[w,y]=(0,i.useState)("available"),j=(0,o.useRouter)();(0,i.useEffect)(()=>{e&&(N(),v())},[e]),(0,i.useEffect)(()=>{let e=d.O.channel("task_notifications").on("broadcast",{event:"task_completed"},e=>{let{type:t,message:a,amount:s}=e.payload,i=Date.now();b(e=>[...e,{id:i.toString(),type:t,message:a,amount:s,timestamp:i}]),setTimeout(()=>{b(e=>e.filter(e=>e.id!==i.toString()))},5e3),N(),v()}).subscribe();return()=>{d.O.removeChannel(e)}},[]);let N=async()=>{if(e)try{let{data:t}=await d.O.from("task_clicks").select("task_id").eq("user_id",e.user_id),s=(null==t?void 0:t.map(e=>e.task_id))||[],{data:i,error:r}=await d.O.from("task_submissions").select("*").eq("status","approved").eq("active",!0).order("created_at",{ascending:!1}).then(e=>{var t;if(e.error)throw e.error;return{data:(null===(t=e.data)||void 0===t?void 0:t.filter(e=>!s.includes(e.id)))||[],error:null}});if(r)throw r;a(i||[])}catch(e){console.error("Error fetching tasks:",e),c.Am.error("Failed to fetch tasks")}},v=async()=>{if(e)try{let{data:t}=await d.O.from("task_clicks").select("task_id").eq("user_id",e.user_id);if(!(null==t?void 0:t.length)){u([]);return}let a=t.map(e=>e.task_id),{data:s,error:i}=await d.O.from("task_submissions").select("*").in("id",a).order("created_at",{ascending:!1});if(i)throw i;u(s||[])}catch(e){console.error("Error fetching completed tasks:",e),c.Am.error("Failed to fetch completed tasks")}},k=async t=>{if(e)try{g(e=>({...e,[t.id]:!0})),window.open(t.link,"_blank"),setTimeout(async()=>{try{let{error:a}=await d.O.from("task_clicks").insert({task_id:t.id,user_id:e.user_id});if(a)throw a;let{data:s,error:i}=await d.O.from("users").select("balance").eq("user_id",e.user_id).single();if(i)throw i;let{error:r}=await d.O.from("users").update({balance:((null==s?void 0:s.balance)||0)+t.payment_amount}).eq("user_id",e.user_id);if(r)throw r;_({id:Date.now().toString(),type:"success",message:"Task completed successfully!",amount:t.payment_amount,timestamp:Date.now()}),N(),v()}catch(e){console.error("Error completing task:",e),_({id:Date.now().toString(),type:"error",message:"Failed to complete task",timestamp:Date.now()})}finally{g(e=>({...e,[t.id]:!1}))}},1e4)}catch(e){console.error("Error handling task:",e),g(e=>({...e,[t.id]:!1}))}},_=e=>{b(t=>[e,...t]),setTimeout(()=>E(e.id),5e3)},E=e=>{b(t=>t.filter(t=>t.id!==e))},D=e=>{switch(e){case"telegram":return"/images/telegram.png";case"youtube":return"/images/youtube.png";case"twitter":return"/images/twitter.png";default:return"/images/link.png"}},C=e=>{switch(e){case"telegram":return"Join";case"youtube":return"Subscribe";case"twitter":return"Follow";default:return"Complete"}};return e?(0,s.jsxs)(r.Z,{children:[(0,s.jsx)(h,{notifications:p,onDismiss:E}),(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)("div",{className:"flex justify-end mb-6",children:(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{onClick:()=>y("available"),className:"px-6 py-2 rounded-lg font-medium transition-all ".concat("available"===w?"bg-accent text-white shadow-lg shadow-accent/20":"bg-primary/20 text-white/60 hover:bg-primary/30"),children:"Available Tasks"}),(0,s.jsx)("button",{onClick:()=>y("completed"),className:"px-6 py-2 rounded-lg font-medium transition-all ".concat("completed"===w?"bg-accent text-white shadow-lg shadow-accent/20":"bg-primary/20 text-white/60 hover:bg-primary/30"),children:"Completed Tasks"})]})}),(0,s.jsx)("div",{className:"space-y-4",children:"available"===w?t.length>0?t.map(e=>(0,s.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-primary/20 backdrop-blur-lg rounded-xl p-6 border border-white/10",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(x.default,{src:D(e.type),alt:e.type,width:24,height:24,className:"w-6 h-6"}),(0,s.jsx)("h3",{className:"text-xl font-semibold",children:e.title})]}),(0,s.jsx)("p",{className:"mt-2 text-white/60",children:e.description}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("span",{className:"text-accent text-lg font-semibold",children:["+",e.payment_amount," MUSKY"]})})]}),(0,s.jsx)(l.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"px-6 py-2 rounded-lg font-semibold ".concat(f[e.id]?"bg-primary/50 cursor-wait":"bg-accent hover:bg-accent/80"),onClick:()=>!f[e.id]&&k(e),disabled:f[e.id],children:f[e.id]?(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(l.E.div,{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),(0,s.jsx)("span",{children:"Processing..."})]}):C(e.type)})]})},e.id)):(0,s.jsxs)("div",{className:"text-center py-12 text-white/60",children:[(0,s.jsx)("p",{className:"text-6xl mb-4",children:"\uD83C\uDFAF"}),(0,s.jsx)("p",{className:"text-xl",children:"No tasks available right now"}),(0,s.jsx)("p",{className:"mt-2",children:"Check back later for new tasks!"})]}):m.length>0?m.map(e=>(0,s.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-primary/10 backdrop-blur-lg rounded-xl p-6 border border-white/5",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(x.default,{src:D(e.type),alt:e.type,width:24,height:24,className:"w-6 h-6"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-white/60",children:e.title})]}),(0,s.jsx)("p",{className:"mt-2 text-white/40",children:e.description}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("span",{className:"text-green-400 text-lg font-semibold",children:["+",e.payment_amount," MUSKY"]})})]}),(0,s.jsx)("div",{className:"px-4 py-1 rounded-full bg-green-500/20 text-green-400 text-sm font-medium",children:"Completed"})]})},e.id)):(0,s.jsxs)("div",{className:"text-center py-12 text-white/60",children:[(0,s.jsx)("p",{className:"text-6xl mb-4",children:"\uD83D\uDCDD"}),(0,s.jsx)("p",{className:"text-xl",children:"No completed tasks yet"}),(0,s.jsx)("p",{className:"mt-2",children:"Complete some tasks to earn rewards!"})]})}),"available"===w&&(0,s.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-8 p-6 bg-primary/20 backdrop-blur-lg rounded-xl border border-white/10",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Create Your Own Campaign"}),(0,s.jsx)("p",{className:"text-sm text-white/60 mt-1",children:"Launch custom tasks and earn when others complete them"})]}),(0,s.jsx)(l.E.button,{className:"px-6 py-2 bg-accent rounded-lg font-medium text-white shadow-lg shadow-accent/20",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>j.push("/tasks/marketplace"),children:"Open Marketplace"})]})})]})]}):(0,s.jsx)(r.Z,{children:(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 flex items-center justify-center min-h-[400px]",children:(0,s.jsx)("p",{className:"text-white/60",children:"Please log in to view tasks"})})})}},7372:function(e,t,a){"use strict";a.d(t,{Z:function(){return c}});var s=a(3827);a(4090);var i=a(8792),r=a(703),l=a(1840),n=a(7907);function c(e){let{children:t}=e,a=(0,n.usePathname)(),c=[{href:"/",label:"Home",icon:"\uD83C\uDFE0"},{href:"/tasks",label:"Tasks",icon:(0,s.jsx)(r.default,{src:"/components/assets/TASKS.png",width:24,height:24,alt:"Tasks"})},{href:"/mining",label:"Mining",icon:"⛏️"},{href:"/refer",label:"Refer",icon:"\uD83D\uDC65"},{href:"/earn",label:"Earn",icon:"\uD83D\uDCB0"}];return(0,s.jsx)("div",{className:"min-h-screen",children:(0,s.jsxs)(l.E.div,{className:"min-h-screen bg-gradient-to-b from-background-start-rgb to-background-end-rgb",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,s.jsx)("main",{className:"container mx-auto px-4 py-8 pb-20",children:(0,s.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:t})}),(0,s.jsx)(l.E.nav,{className:"fixed bottom-0 left-0 right-0 bg-white/10 backdrop-blur-lg border-t border-white/20",initial:{y:100},animate:{y:0},transition:{duration:.5},children:(0,s.jsx)("div",{className:"container mx-auto px-4",children:(0,s.jsx)("div",{className:"flex justify-between items-center py-2",children:c.map(e=>(0,s.jsxs)(i.default,{href:e.href,className:"relative flex flex-col items-center p-2 group",children:[(0,s.jsx)(l.E.span,{className:"text-2xl transition-transform duration-200 ".concat(a===e.href?"scale-110":"scale-100"),whileHover:{scale:1.1},whileTap:{scale:.9},children:e.icon}),(0,s.jsx)("span",{className:"text-xs mt-1 ".concat(a===e.href?"text-white font-bold":"text-white/60"),children:e.label}),a===e.href&&(0,s.jsx)(l.E.div,{className:"absolute -bottom-2 w-12 h-1 bg-accent rounded-full",layoutId:"activeTab",transition:{type:"spring",bounce:.2}})]},e.href))})})})]})})}}},function(e){e.O(0,[840,965,134,548,971,69,744],function(){return e(e.s=307)}),_N_E=e.O()}]);