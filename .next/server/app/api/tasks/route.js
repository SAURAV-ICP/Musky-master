"use strict";(()=>{var e={};e.id=495,e.ids=[495],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},1808:e=>{e.exports=require("net")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},4404:e=>{e.exports=require("tls")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")},440:(e,t,s)=>{s.r(t),s.d(t,{headerHooks:()=>y,originalPathname:()=>f,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>k,staticGenerationBailout:()=>_});var r={};s.r(r),s.d(r,{GET:()=>l,POST:()=>p});var a=s(5419),o=s(9108),i=s(9678),n=s(8070),u=s(6517);let c=[{type:"telegram",title:"Join BoomBets Official",description:"Join our partner channel BoomBets Official for latest updates",link:"https://t.me/boombetsofficial",payment_amount:2e3,status:"approved",clicks_wanted:1e4,clicks_received:0,payment_type:"stars",button_text:"Join Channel"},{type:"telegram",title:"Join Musky Group Chat",description:"Join the official Musky community chat",link:"https://t.me/musky_groupchat",payment_amount:2e3,status:"approved",clicks_wanted:1e4,clicks_received:0,payment_type:"stars",button_text:"Join Group"},{type:"telegram",title:"Join Musky on Solana",description:"Join the official Musky on Solana channel",link:"https://t.me/musky_on_solana",payment_amount:2e3,status:"approved",clicks_wanted:1e4,clicks_received:0,payment_type:"stars",button_text:"Join Channel"}];async function l(e){try{let{searchParams:t}=new URL(e.url),s=t.get("status")||"approved",r=t.get("user_id"),{data:a}=await u.O.from("task_submissions").select("*").limit(1);a&&0!==a.length||await u.O.from("task_submissions").insert(c.map(e=>({...e,created_at:new Date().toISOString()})));let o=u.O.from("task_submissions").select("*").eq("status",s).order("created_at",{ascending:!1});r&&(o=o.eq("user_id",r));let{data:i,error:l}=await o;if(l)throw l;return n.Z.json({tasks:i})}catch(e){return console.error("GET tasks error:",e),n.Z.json({error:"Failed to fetch tasks"},{status:500})}}async function p(e){try{let{task_id:t,user_id:s}=await e.json();if(!t||!s)return n.Z.json({error:"Task ID and User ID are required"},{status:400});let{data:r}=await u.O.from("task_clicks").select("*").eq("task_id",t).eq("user_id",s).single();if(r)return n.Z.json({error:"Task already completed"},{status:400});let{data:a,error:o}=await u.O.from("task_submissions").select("*").eq("id",t).eq("status","approved").single();if(o||!a)return n.Z.json({error:"Task not found or not approved"},{status:404});let{error:i}=await u.O.from("task_clicks").insert({task_id:t,user_id:s});if(i)throw i;return await u.O.from("task_submissions").update({clicks_received:(a.clicks_received||0)+1}).eq("id",t),setTimeout(async()=>{try{let{data:e,error:t}=await u.O.from("users").select("balance").eq("user_id",s).single();if(t)throw t;let{data:r,error:o}=await u.O.from("users").update({balance:(e?.balance||0)+a.payment_amount}).eq("user_id",s).select().single();if(o)throw o;await u.O.channel("task_completion").send({type:"broadcast",event:"task_completed",payload:{type:"success",message:"Task completed successfully!",amount:a.payment_amount}})}catch(e){console.error("Error in delayed balance update:",e)}},1e4),n.Z.json({success:!0,message:"Task completion recorded",reward:a.payment_amount})}catch(e){return console.error("POST tasks error:",e),n.Z.json({error:"Failed to complete task"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/tasks/route",pathname:"/api/tasks",filename:"route",bundlePath:"app/api/tasks/route"},resolvedPagePath:"/Users/sauravlamichhane/Downloads/Musky-master/src/app/api/tasks/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:k,serverHooks:h,headerHooks:y,staticGenerationBailout:_}=d,f="/api/tasks/route";function w(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:k})}},6517:(e,t,s)=>{s.d(t,{O:()=>i});var r=s(7890);let a="https://pkaooixolhnhdyajwlgw.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrYW9vaXhvbGhuaGR5YWp3bGd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk5NDQzMDEsImV4cCI6MjA1NTUyMDMwMX0.ATOLcUZaP--eojDV0ugG0bujlOkzam0q7A6e9IIKnxY";if(!a||!o)throw Error("Missing Supabase credentials");let i=(0,r.eI)(a,o)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,159],()=>s(440));module.exports=r})();