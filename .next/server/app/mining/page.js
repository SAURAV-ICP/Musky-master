(()=>{var e={};e.id=1617,e.ids=[1617],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},8275:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>o});var a=t(482),r=t(9108),n=t(2563),i=t.n(n),l=t(8300),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let o=["",{children:["mining",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3137)),"/Users/sauravlamichhane/Downloads/Musky-master/src/app/mining/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,1342)),"/Users/sauravlamichhane/Downloads/Musky-master/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9361,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/sauravlamichhane/Downloads/Musky-master/src/app/mining/page.tsx"],m="/mining/page",x={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/mining/page",pathname:"/mining",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},3047:(e,s,t)=>{Promise.resolve().then(t.bind(t,1732))},1732:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var a=t(5344),r=t(3729),n=t(4573),i=t(8110),l=t(9410),c=t(3644),o=t(4394);let d=({gpu:e,onClose:s,onPurchase:t,canPurchase:n,owned:d})=>{let[m,x]=(0,r.useState)(!1),[h,u]=(0,r.useState)("TON");if(!e)return null;let p=async()=>{x(!1),await t(e)},f=e.miningRatePerDay/86400,g=e.miningRatePerDay/1440,j=e.miningRatePerDay/24,b=30*e.miningRatePerDay,y=150*b,N=6.5*e.price.ton,w=N/(150*e.miningRatePerDay);return a.jsx(c.M,{children:a.jsx(i.E.div,{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s,children:a.jsx(i.E.div,{className:"bg-primary/90 backdrop-blur-xl rounded-2xl w-full max-w-lg overflow-hidden",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},onClick:e=>e.stopPropagation(),children:m?(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold",children:["Purchase ",e.name]}),a.jsx("button",{onClick:()=>x(!1),className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-white/80 hover:bg-black/40 transition-colors",children:"←"})]}),a.jsx(o.Z,{amount:e.price[h.toLowerCase()]||e.price.ton,currency:h,itemType:e.name,onSuccess:p,onCancel:()=>{x(!1)}})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative h-48 bg-gradient-to-b from-accent/20 to-primary/20",children:[e.image.endsWith(".mov")?a.jsx("video",{src:e.image,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-contain"}):a.jsx(l.default,{src:e.image,alt:e.name,fill:!0,className:"object-contain p-4"}),a.jsx("button",{onClick:s,className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-white/80 hover:bg-black/40 transition-colors",children:"✕"})]}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-bold",children:e.name}),a.jsx("p",{className:"text-accent text-lg",children:e.hashrate}),(0,a.jsxs)("p",{className:"text-sm text-white/60",children:["Duration: ",e.duration]})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm text-white/60",children:"Owned"}),(0,a.jsxs)("p",{className:"font-bold text-lg",children:[d,"/",e.maxPurchase]})]})]}),(0,a.jsxs)("div",{className:"mb-6 bg-black/20 rounded-lg p-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Mining Performance"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-xs text-white/60",children:"Per Second"}),(0,a.jsxs)("p",{className:"font-bold text-green-400",children:[f.toFixed(8)," SOL"]})]}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-xs text-white/60",children:"Per Minute"}),(0,a.jsxs)("p",{className:"font-bold text-green-400",children:[g.toFixed(6)," SOL"]})]}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-xs text-white/60",children:"Per Hour"}),(0,a.jsxs)("p",{className:"font-bold text-green-400",children:[j.toFixed(4)," SOL"]})]}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-xs text-white/60",children:"Per Day"}),(0,a.jsxs)("p",{className:"font-bold text-green-400",children:[e.miningRatePerDay.toFixed(2)," SOL"]})]})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-white/10",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-white/60",children:"Total Mining (30 days)"}),(0,a.jsxs)("p",{className:"font-bold text-green-400",children:[b.toFixed(2)," SOL"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm text-white/60",children:"Estimated Value"}),(0,a.jsxs)("p",{className:"font-bold text-green-400",children:["$",y.toFixed(2)," USD"]})]})]})}),a.jsx("div",{className:"mt-4 pt-4 border-t border-white/10",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-white/60",children:"ROI Period"}),(0,a.jsxs)("p",{className:"font-bold text-accent",children:[w.toFixed(1)," days"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm text-white/60",children:"ROI Percentage"}),(0,a.jsxs)("p",{className:"font-bold text-accent",children:["+",(y/N*100-100).toFixed(0),"%"]})]})]})})]}),(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Specifications"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-black/20 rounded-lg p-3",children:[a.jsx("p",{className:"text-sm text-white/60",children:"CUDA Cores"}),a.jsx("p",{className:"font-bold",children:e.specs.cores.toLocaleString()})]}),(0,a.jsxs)("div",{className:"bg-black/20 rounded-lg p-3",children:[a.jsx("p",{className:"text-sm text-white/60",children:"Memory"}),a.jsx("p",{className:"font-bold",children:e.specs.memory})]}),(0,a.jsxs)("div",{className:"bg-black/20 rounded-lg p-3",children:[a.jsx("p",{className:"text-sm text-white/60",children:"Power Draw"}),a.jsx("p",{className:"font-bold",children:e.specs.power})]}),(0,a.jsxs)("div",{className:"bg-black/20 rounded-lg p-3",children:[a.jsx("p",{className:"text-sm text-white/60",children:"Mining Efficiency"}),a.jsx("p",{className:"font-bold",children:e.specs.efficiency})]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Description"}),a.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:e.description})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Payment Options"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[e.price.ton&&a.jsx(i.E.button,{className:`py-2 px-3 rounded-lg text-center ${"TON"===h?"bg-accent text-white":"bg-black/20 text-white/70"}`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>u("TON"),children:(0,a.jsxs)("div",{className:"font-bold",children:[e.price.ton," TON"]})}),e.price.stars&&a.jsx(i.E.button,{className:`py-2 px-3 rounded-lg text-center ${"Stars"===h?"bg-accent text-white":"bg-black/20 text-white/70"}`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>u("Stars"),children:(0,a.jsxs)("div",{className:"font-bold",children:[e.price.stars.toLocaleString()," Stars"]})}),e.price.musky&&a.jsx(i.E.button,{className:`py-2 px-3 rounded-lg text-center ${"MUSKY"===h?"bg-accent text-white":"bg-black/20 text-white/70"}`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>u("MUSKY"),children:(0,a.jsxs)("div",{className:"font-bold",children:[e.price.musky.toLocaleString()," MUSKY"]})})]}),a.jsx(i.E.button,{className:`w-full py-3 rounded-lg font-bold ${n?"bg-orange-500 hover:bg-orange-400":"bg-gray-500 cursor-not-allowed"}`,whileHover:n?{scale:1.02}:{},whileTap:n?{scale:.98}:{},onClick:()=>{n&&x(!0)},children:n?`Purchase with ${h}`:"Locked"}),!n&&d<e.maxPurchase&&a.jsx("p",{className:"text-xs text-orange-400 mt-2 text-center",children:"RTX5070"===e.name?"You need to own at least one RTX4090 first":"RTX5090"===e.name?"You need to own at least one RTX5070 first":"Maximum GPU limit reached (8)"})]})]})]})})})})};var m=t(4212),x=t(4669);let h=[{id:1,name:"RTX4070",hashrate:"0.03 SOL/day",duration:"30 days",price:{musky:4e4,ton:5,stars:2500},specs:{cores:5888,memory:"12GB GDDR6X",power:"200W",efficiency:"0.00015 SOL/W/day"},image:"/components/assets/4070TI.jpg",description:"Entry-level mining GPU with reliable performance. Mines 0.03 SOL per day for 30 days (total 0.9 SOL).",maxPurchase:2,miningRatePerDay:.03},{id:2,name:"RTX4090",hashrate:"0.08 SOL/day",duration:"30 days",price:{musky:7e4,ton:9,stars:5e3},specs:{cores:16384,memory:"24GB GDDR6X",power:"450W",efficiency:"0.00018 SOL/W/day"},image:"/components/assets/4090ti.jpg",description:"High-performance GPU for serious miners. Mines 0.08 SOL per day for 30 days (total 2.4 SOL).",maxPurchase:2,miningRatePerDay:.08},{id:3,name:"RTX5070",hashrate:"0.25 SOL/day",duration:"30 days",price:{musky:125e3,ton:25,stars:12500},specs:{cores:7680,memory:"16GB GDDR7",power:"220W",efficiency:"0.00114 SOL/W/day"},image:"/components/assets/5070ti.jpg",description:"Next-gen mining GPU with enhanced efficiency. Mines 0.25 SOL per day for 30 days (total 7.5 SOL).",maxPurchase:2,miningRatePerDay:.25},{id:4,name:"RTX5090",hashrate:"0.5 SOL/day",duration:"30 days",price:{musky:25e4,ton:50,stars:25e3},specs:{cores:18432,memory:"32GB GDDR7",power:"500W",efficiency:"0.001 SOL/W/day"},image:"/components/assets/5090ti.mov",description:"Ultimate mining GPU for maximum returns. Mines 0.5 SOL per day for 30 days (total 15 SOL).",maxPurchase:2,miningRatePerDay:.5}];function u(){let{user:e,mutate:s}=(0,m.a)(),[t,c]=(0,r.useState)(null),[u,p]=(0,r.useState)({}),[f,g]=(0,r.useState)(0),[j,b]=(0,r.useState)(!1),[y,N]=(0,r.useState)("TON"),[w,v]=(0,r.useState)(!0),[S,P]=(0,r.useState)(0),[k,M]=(0,r.useState)(0),[L,O]=(0,r.useState)(0),[R,T]=(0,r.useState)(0),[U,E]=(0,r.useState)(Date.now()),[D,_]=(0,r.useState)(!1),[C,q]=(0,r.useState)(0),[Y,$]=(0,r.useState)(Date.now()),[G,F]=(0,r.useState)(0);(0,r.useEffect)(()=>{if(e){console.log("User data in mining page:",{userId:e.user_id,isAdmin:e.is_admin,adminId:"7093793454"}),A(),_(!0===e.is_admin);let s=setInterval(()=>{A(),$(Date.now()),F(6e5)},6e5),t=setInterval(()=>{K()},1e3);return()=>{clearInterval(s),clearInterval(t)}}},[e]),(0,r.useEffect)(()=>{if(e){P(e.mining_rate||0),M(e.solana_balance||0);let s=e.mining_rate||0;O(s/86400),T(s/1440),E(Date.now()),F(6e5)}},[e]);let K=()=>{let e=Date.now(),s=(e-U)/1e3;if(S>0){M(k+L*s);let t=e-Y;q(Math.min(t/6e5*100,100)),F(Math.max(0,6e5-t))}E(e)},A=async()=>{if(e?.user_id)try{v(!0);let s=await fetch(`/api/mining/gpus?user_id=${e.user_id}`);if(s.ok){let e=await s.json();if(console.log("Mining data received:",e),void 0!==e.is_admin&&(_(!0===e.is_admin),console.log("Admin status updated from API:",e.is_admin)),e.gpus&&(p(e.gpus),g(e.activeCount||0)),void 0!==e.miningRate){P(e.miningRate);let s=e.miningRate;O(s/86400),T(s/1440)}void 0!==e.solanaBalance&&M(e.solanaBalance),E(Date.now()),$(Date.now()),F(6e5)}else console.error("Failed to fetch GPU data:",await s.text())}catch(e){console.error("Failed to fetch GPU data:",e)}finally{v(!1)}},I=s=>{if(!e)return!1;if(D)return console.log("Admin user can purchase GPU"),!0;let t=u[s.name]||0;return"RTX4070"===s.name||"RTX4090"===s.name?t<s.maxPurchase&&f<8:"RTX5070"===s.name?(u.RTX4090||0)>0&&t<s.maxPurchase&&f<8:"RTX5090"===s.name&&(u.RTX5070||0)>0&&t<s.maxPurchase&&f<8},X=async e=>{if(!I(e)){x.Am.error("Purchase previous GPUs first or max limit reached");return}c(e),b(!0)},W=async()=>{b(!1);try{await A(),await s(),x.Am.success(`${t?.name} purchased successfully!`)}catch(e){console.error("Error updating after purchase:",e)}c(null)},z=()=>{b(!1),c(null)},B=e=>(150*e).toFixed(2);return a.jsx(n.Z,{children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Mining Farm"}),a.jsx("p",{className:"text-white/60",children:"Mine Solana with your GPUs"})]}),D&&a.jsx("div",{className:"bg-orange-500/20 px-3 py-1 rounded-full",children:a.jsx("p",{className:"text-orange-400 text-sm font-bold",children:"Admin Mode"})})]}),a.jsx("div",{className:"bg-primary-dark p-6 rounded-xl mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-black/20 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-lg font-bold mb-2",children:"Mining Rate"}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-xs text-white/60",children:"Per Second:"}),(0,a.jsxs)("p",{className:"font-mono text-accent",children:[L.toFixed(8)," SOL/s"]}),a.jsx("p",{className:"text-xs text-white/60",children:"Per Minute:"}),(0,a.jsxs)("p",{className:"font-mono text-accent",children:[R.toFixed(6)," SOL/min"]}),a.jsx("p",{className:"text-xs text-white/60",children:"Per Day:"}),(0,a.jsxs)("p",{className:"font-mono text-accent",children:[S.toFixed(4)," SOL/day"]}),a.jsx("p",{className:"text-xs text-white/60",children:"Estimated Monthly:"}),(0,a.jsxs)("p",{className:"font-mono text-accent",children:[(30*S).toFixed(4)," SOL/month"]})]})]}),(0,a.jsxs)("div",{className:"bg-black/20 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-lg font-bold mb-2",children:"Mining Progress"}),a.jsx("div",{className:"mb-2",children:a.jsx("div",{className:"h-4 bg-black/30 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-accent rounded-full",style:{width:`${C}%`}})})}),(0,a.jsxs)("p",{className:"text-xs text-white/60 mb-2",children:["Next server update in ",Math.floor(G/6e4),"m ",Math.floor(G%6e4/1e3),"s"]}),a.jsx("p",{className:"text-xs text-white/60",children:"Your mining continues even when offline"}),(0,a.jsxs)("p",{className:"text-sm mt-2",children:[a.jsx("span",{className:"text-white/60",children:"Current Balance:"})," ",(0,a.jsxs)("span",{className:"font-bold",children:[k.toFixed(6)," SOL"]})]}),(0,a.jsxs)("p",{className:"text-xs text-white/60",children:["≈ $",B(k)," USD"]})]}),(0,a.jsxs)("div",{className:"bg-black/20 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your GPUs"}),(0,a.jsxs)("div",{className:"space-y-2",children:[Object.entries(u).map(([e,s])=>s>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{children:e}),(0,a.jsxs)("span",{className:"font-bold",children:[s,"x"]})]},e)),Object.values(u).every(e=>0===e)&&a.jsx("p",{className:"text-white/60",children:"No GPUs yet. Purchase below!"})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-white/10",children:[a.jsx("p",{className:"text-xs text-white/60",children:"Active GPUs:"}),(0,a.jsxs)("p",{className:"font-bold",children:[f,"/8"]}),a.jsx("p",{className:"text-xs text-white/60 mt-2",children:"Total Mining (30 days):"}),(0,a.jsxs)("p",{className:"font-bold",children:[(30*S).toFixed(4)," SOL"]}),(0,a.jsxs)("p",{className:"text-xs text-white/60",children:["≈ $",B(30*S)," USD"]})]})]})]})}),a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Available Mining Equipment"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:h.map(e=>(0,a.jsxs)(i.E.div,{className:`bg-primary-dark p-6 rounded-xl border-2 transition-all ${u[e.name]&&u[e.name]>0?"border-accent/30 hover:border-accent":"border-white/10 opacity-70"}`,whileHover:{scale:1.02},onClick:()=>c(e),children:[a.jsx("div",{className:"relative h-48 mb-4",children:"RTX5090"===e.name?a.jsx("video",{src:e.image,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-contain"}):a.jsx(l.default,{src:e.image,alt:e.name,fill:!0,className:"object-contain"})}),(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:e.name}),a.jsx("p",{className:"text-accent",children:e.hashrate}),(0,a.jsxs)("p",{className:"text-xs text-white/60",children:["Duration: ",e.duration]})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm text-white/60",children:"Owned"}),(0,a.jsxs)("p",{className:"font-bold",children:[u[e.name]||0,"/2"]})]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[a.jsx("p",{className:"text-sm text-white/60",children:"Price:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mt-1",children:[e.price.musky&&(0,a.jsxs)("span",{className:"text-xs bg-black/20 px-2 py-1 rounded",children:[e.price.musky.toLocaleString()," MUSKY"]}),(0,a.jsxs)("span",{className:"text-xs bg-black/20 px-2 py-1 rounded",children:[e.price.ton," TON"]}),(0,a.jsxs)("span",{className:"text-xs bg-black/20 px-2 py-1 rounded",children:[e.price.stars.toLocaleString()," Stars"]})]})]}),a.jsx(i.E.button,{className:`w-full py-2 rounded-lg font-bold ${I(e)?"bg-orange-500 hover:bg-orange-400":"bg-gray-500 cursor-not-allowed"}`,whileHover:I(e)?{scale:1.02}:{},whileTap:I(e)?{scale:.98}:{},onClick:s=>{s.stopPropagation(),I(e)&&X(e)},children:I(e)?"Purchase":"Locked"})]},e.id))}),t&&!j&&a.jsx(d,{gpu:t,onClose:()=>c(null),onPurchase:e=>X(e),canPurchase:I(t),owned:u[t.name]||0}),t&&j&&a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:a.jsx("div",{className:"bg-primary/90 backdrop-blur-xl rounded-2xl w-full max-w-lg overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold",children:["Purchase ",t.name]}),a.jsx("button",{onClick:z,className:"w-8 h-8 rounded-full bg-black/20 flex items-center justify-center text-white/80 hover:bg-black/40 transition-colors",children:"✕"})]}),a.jsx(o.Z,{amount:t.price[y.toLowerCase()]||t.price.ton,currency:y,itemType:t.name,onSuccess:W,onCancel:z})]})})})]})})}},4394:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});var a=t(5344),r=t(3729),n=t(4212);let i=({amount:e,currency:s,itemType:t,onSuccess:i,onCancel:l})=>{let{user:c,mutate:o}=(0,n.a)(),[d,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),[u,p]=(0,r.useState)(null),[f,g]=(0,r.useState)("initializing"),j=async()=>{if(!c){p("User not found. Please refresh the page.");return}m(!0),p(null),g("initializing");try{if("TON"===s||"Stars"===s)console.error("Telegram Web App is not available"),p("Telegram Web App is not available. Please open this app in Telegram."),g("failed");else if("MUSKY"===s){if(g("checking_balance"),console.log(`Processing MUSKY payment of ${e} for ${t}`),c.balance<e){console.error("Insufficient MUSKY balance"),p(`Insufficient MUSKY balance. You have ${c.balance.toLocaleString()} MUSKY, but need ${e.toLocaleString()} MUSKY.`),g("failed");return}g("processing_backend");let s=await fetch("/api/payments/process",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:c.user_id,amount:e,currency:"MUSKY",item_type:t})});if(s.ok){let e=await s.json();console.log("MUSKY payment successful:",e),h(!0),g("completed"),await o(),setTimeout(()=>{i()},1500)}else{let e="Failed to process payment";try{e=(await s.json()).error||e}catch(t){e=await s.text()||e}console.error("MUSKY payment failed:",e),p(e),g("failed")}}}catch(e){console.error("Payment error:",e),p("An unexpected error occurred. Please try again."),g("failed")}finally{m(!1)}};(0,r.useEffect)(()=>{let e=setTimeout(()=>{j()},500);return()=>clearTimeout(e)},[]);let b=(()=>{let t={};return"TON"===s?(t.MUSKY=8e3*e,t.Stars=500*e):"Stars"===s?(t.MUSKY=16*e,t.TON=e/500):"MUSKY"===s&&(t.TON=e/8e3,t.Stars=e/16),t})(),y=()=>{switch(f){case"initializing":return"Initializing payment...";case"requesting_telegram_payment":return"Requesting payment from Telegram...";case"checking_balance":return"Checking your balance...";case"processing_backend":return"Processing your payment...";case"completed":return"Payment successful!";case"failed":return"Payment failed";default:return"Processing..."}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Processing Payment"}),a.jsx("p",{className:"text-white/60",children:d?y():x?"Payment successful!":u?"Payment failed":`Paying ${e} ${s} for ${t}`})]}),(0,a.jsxs)("div",{className:"bg-black/20 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"text-white/60",children:"Amount:"}),(0,a.jsxs)("span",{className:"font-bold",children:[e.toLocaleString()," ",s]})]}),(0,a.jsxs)("div",{className:"space-y-1 text-sm text-white/60",children:["MUSKY"!==s&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Equivalent MUSKY:"}),(0,a.jsxs)("span",{children:[b.MUSKY.toLocaleString()," MUSKY"]})]}),"TON"!==s&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Equivalent TON:"}),(0,a.jsxs)("span",{children:[b.TON.toFixed(4)," TON"]})]}),"Stars"!==s&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Equivalent Stars:"}),(0,a.jsxs)("span",{children:[b.Stars.toLocaleString()," Stars"]})]})]}),"MUSKY"===s&&c&&a.jsx("div",{className:"mt-3 pt-3 border-t border-white/10",children:(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-white/60",children:"Your MUSKY Balance:"}),(0,a.jsxs)("span",{className:c.balance>=e?"text-green-400":"text-red-400",children:[c.balance.toLocaleString()," MUSKY"]})]})})]}),a.jsx("div",{className:"flex justify-center",children:d?(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-t-accent border-white/20 rounded-full animate-spin mb-4"}),a.jsx("p",{className:"text-white/60",children:y()})]}):x?(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mb-4",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsx("p",{className:"text-green-400",children:"Payment successful!"})]}):u?(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mb-4",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),a.jsx("p",{className:"text-red-400 mb-2",children:u}),a.jsx("button",{onClick:l,className:"px-4 py-2 bg-black/20 rounded-lg hover:bg-black/30 transition-colors",children:"Go Back"})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-t-accent border-white/20 rounded-full animate-spin mb-4"}),a.jsx("p",{className:"text-white/60",children:"Initializing payment..."})]})})]})}},3137:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>n,__esModule:()=>r,default:()=>i});let a=(0,t(6843).createProxy)(String.raw`/Users/sauravlamichhane/Downloads/Musky-master/src/app/mining/page.tsx`),{__esModule:r,$$typeof:n}=a,i=a.default},3644:(e,s,t)=>{"use strict";t.d(s,{M:()=>f});var a=t(3729),r=t(9038);function n(){let e=(0,a.useRef)(!1);return(0,r.L)(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var i=t(1475),l=t(5986),c=t(207);class o extends a.Component{getSnapshotBeforeUpdate(e){let s=this.props.childRef.current;if(s&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=s.offsetHeight||0,e.width=s.offsetWidth||0,e.top=s.offsetTop,e.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function d({children:e,isPresent:s}){let t=(0,a.useId)(),r=(0,a.useRef)(null),n=(0,a.useRef)({width:0,height:0,top:0,left:0});return(0,a.useInsertionEffect)(()=>{let{width:e,height:a,top:i,left:l}=n.current;if(s||!r.current||!e||!a)return;r.current.dataset.motionPopId=t;let c=document.createElement("style");return document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${a}px !important;
            top: ${i}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[s]),a.createElement(o,{isPresent:s,childRef:r,sizeRef:n},a.cloneElement(e,{ref:r}))}let m=({children:e,initial:s,isPresent:t,onExitComplete:r,custom:n,presenceAffectsLayout:i,mode:o})=>{let m=(0,c.h)(x),h=(0,a.useId)(),u=(0,a.useMemo)(()=>({id:h,initial:s,isPresent:t,custom:n,onExitComplete:e=>{for(let s of(m.set(e,!0),m.values()))if(!s)return;r&&r()},register:e=>(m.set(e,!1),()=>m.delete(e))}),i?void 0:[t]);return(0,a.useMemo)(()=>{m.forEach((e,s)=>m.set(s,!1))},[t]),a.useEffect(()=>{t||m.size||!r||r()},[t]),"popLayout"===o&&(e=a.createElement(d,{isPresent:t},e)),a.createElement(l.O.Provider,{value:u},e)};function x(){return new Map}var h=t(6828),u=t(7222);let p=e=>e.key||"",f=({children:e,custom:s,initial:t=!0,onExitComplete:l,exitBeforeEnter:c,presenceAffectsLayout:o=!0,mode:d="sync"})=>{var x;(0,u.k)(!c,"Replace exitBeforeEnter with mode='wait'");let f=(0,a.useContext)(h.p).forceRender||function(){let e=n(),[s,t]=(0,a.useState)(0),r=(0,a.useCallback)(()=>{e.current&&t(s+1)},[s]);return[(0,a.useCallback)(()=>i.Wi.postRender(r),[r]),s]}()[0],g=n(),j=function(e){let s=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&s.push(e)}),s}(e),b=j,y=(0,a.useRef)(new Map).current,N=(0,a.useRef)(b),w=(0,a.useRef)(new Map).current,v=(0,a.useRef)(!0);if((0,r.L)(()=>{v.current=!1,function(e,s){e.forEach(e=>{let t=p(e);s.set(t,e)})}(j,w),N.current=b}),x=()=>{v.current=!0,w.clear(),y.clear()},(0,a.useEffect)(()=>()=>x(),[]),v.current)return a.createElement(a.Fragment,null,b.map(e=>a.createElement(m,{key:p(e),isPresent:!0,initial:!!t&&void 0,presenceAffectsLayout:o,mode:d},e)));b=[...b];let S=N.current.map(p),P=j.map(p),k=S.length;for(let e=0;e<k;e++){let s=S[e];-1!==P.indexOf(s)||y.has(s)||y.set(s,void 0)}return"wait"===d&&y.size&&(b=[]),y.forEach((e,t)=>{if(-1!==P.indexOf(t))return;let r=w.get(t);if(!r)return;let n=S.indexOf(t),i=e;i||(i=a.createElement(m,{key:p(r),isPresent:!1,onExitComplete:()=>{y.delete(t);let e=Array.from(w.keys()).filter(e=>!P.includes(e));if(e.forEach(e=>w.delete(e)),N.current=j.filter(s=>{let a=p(s);return a===t||e.includes(a)}),!y.size){if(!1===g.current)return;f(),l&&l()}},custom:s,presenceAffectsLayout:o,mode:d},r),y.set(t,i)),b.splice(n,0,i)}),b=b.map(e=>{let s=e.key;return y.has(s)?e:a.createElement(m,{key:p(e),isPresent:!0,presenceAffectsLayout:o,mode:d},e)}),a.createElement(a.Fragment,null,y.size?b:b.map(e=>(0,a.cloneElement)(e)))}}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[1638,8575,8110,7822,9657],()=>t(8275));module.exports=a})();