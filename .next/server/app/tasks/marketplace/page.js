(()=>{var e={};e.id=6979,e.ids=[6979],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},1408:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>o});var r=s(482),a=s(9108),i=s(2563),l=s.n(i),n=s(8300),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);s.d(t,c);let o=["",{children:["tasks",{children:["marketplace",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9006)),"/Users/sauravlamichhane/Downloads/Musky-master/src/app/tasks/marketplace/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1342)),"/Users/sauravlamichhane/Downloads/Musky-master/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/sauravlamichhane/Downloads/Musky-master/src/app/tasks/marketplace/page.tsx"],u="/tasks/marketplace/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/tasks/marketplace/page",pathname:"/tasks/marketplace",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9274:(e,t,s)=>{Promise.resolve().then(s.bind(s,6569))},6569:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(5344),a=s(3729),i=s(4573),l=s(4212),n=s(4669),c=s(8428),o=s(8110),d=s(8704);function u(){let{user:e,loading:t}=(0,l.a)(),s=(0,c.useRouter)(),[u,p]=(0,a.useState)({type:"telegram",title:"",description:"",link:"",clicks_wanted:1e3,payment_type:"stars"}),[m,x]=(0,a.useState)([]),[h,b]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!e){s.push("/login");return}e.user_id&&y()},[e,s]);let y=async()=>{try{let t=await fetch(`/api/admin/tasks?userId=${e?.user_id}`);if(t.ok){let s=await t.json();x(s.tasks.filter(t=>t.user_id===e?.user_id&&"approved"!==t.status)||[])}else{let e=await t.json();n.Am.error(e.error||"Failed to fetch user tasks")}}catch(e){console.error("Error fetching user tasks:",e),n.Am.error("Failed to fetch user tasks")}},k=async t=>{if(t.preventDefault(),!e?.user_id){n.Am.error("Please log in to submit a task");return}b(!0);try{if(!u.type||!["telegram","youtube","twitter"].includes(u.type)){n.Am.error("Invalid or missing task type"),b(!1);return}if(!u.title||!u.description||!u.link||!u.clicks_wanted){n.Am.error("Missing required fields: title, description, link, and clicks wanted are required"),b(!1);return}if(u.clicks_wanted<1e3||u.clicks_wanted>1e6){n.Am.error("Clicks must be between 1,000 and 1,000,000"),b(!1);return}let t=2*u.clicks_wanted,s="stars"===u.payment_type?t:t/500,r="stars"===u.payment_type?"stars_balance":"ton_balance",{data:a,error:i}=await d.O.from("users").select(r).eq("user_id",e.user_id).single();if(i||!a){n.Am.error("User balance not found"),b(!1);return}if(a[r]<s){n.Am.error("Insufficient balance"),b(!1);return}let l=await fetch("/api/admin/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...u,user_id:e.user_id,payment_amount:s,payment_type:u.payment_type,status:"pending",payment_amount_locked:2e3})});if(!l.ok){let e=await l.json();n.Am.error(e.error||"Failed to submit task"),b(!1);return}let c=await l.json();c.success?(n.Am.success("Task submitted for review successfully"),p({type:"telegram",title:"",description:"",link:"",clicks_wanted:1e3,payment_type:"stars"}),y()):n.Am.error(c.error||"Failed to submit task")}catch(e){console.error("Error submitting task:",e),n.Am.error("Failed to submit task")}finally{b(!1)}},g=e=>{switch(e?.toLowerCase()){case"telegram":return"Join";case"youtube":return"Watch";case"twitter":return"Follow";default:return"Complete"}};return t?r.jsx(i.Z,{children:r.jsx("div",{className:"max-w-2xl mx-auto px-4 flex items-center justify-center min-h-[400px]",children:r.jsx("p",{className:"text-white/60",children:"Loading..."})})}):r.jsx(i.Z,{children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[r.jsx("h1",{className:"text-2xl font-bold text-white mb-6",children:"Ad Marketplace"}),(0,r.jsxs)("div",{className:"mb-8 p-6 bg-primary/20 backdrop-blur-lg rounded-xl border border-white/10",children:[r.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Create Your Ad Campaign"}),(0,r.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-white/60 mb-1",children:"Task Type"}),(0,r.jsxs)("select",{value:u.type||"telegram",onChange:e=>{p({...u,type:e.target.value})},className:"w-full px-4 py-2 rounded-lg bg-black/20 border border-white/10 text-white",children:[r.jsx("option",{value:"telegram",children:"Telegram"}),r.jsx("option",{value:"youtube",children:"YouTube"}),r.jsx("option",{value:"twitter",children:"Twitter"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-white/60 mb-1",children:"Title"}),r.jsx("input",{type:"text",value:u.title||"",onChange:e=>p({...u,title:e.target.value}),className:"w-full px-4 py-2 rounded-lg bg-black/20 border border-white/10",placeholder:"Ad title"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-white/60 mb-1",children:"Description"}),r.jsx("textarea",{value:u.description||"",onChange:e=>p({...u,description:e.target.value}),className:"w-full px-4 py-2 rounded-lg bg-black/20 border border-white/10 h-24",placeholder:"Ad description"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-white/60 mb-1",children:"Link"}),r.jsx("input",{type:"text",value:u.link||"",onChange:e=>p({...u,link:e.target.value}),className:"w-full px-4 py-2 rounded-lg bg-black/20 border border-white/10",placeholder:"Enter ad link"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-white/60 mb-1",children:"Clicks Wanted (1,000â€“1,000,000)"}),r.jsx("input",{type:"number",value:u.clicks_wanted||1e3,onChange:e=>p({...u,clicks_wanted:parseInt(e.target.value)||1e3}),className:"w-full px-4 py-2 rounded-lg bg-black/20 border border-white/10",min:"1000",max:"1000000",placeholder:"Number of clicks (min 1,000)"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-white/60 mb-1",children:"Payment Type"}),(0,r.jsxs)("select",{value:u.payment_type||"stars",onChange:e=>{p({...u,payment_type:e.target.value})},className:"w-full px-4 py-2 rounded-lg bg-black/20 border border-white/10 text-white",children:[r.jsx("option",{value:"stars",children:"Stars (2 Stars per click, min 2,000)"}),r.jsx("option",{value:"ton",children:"TON (4 TON minimum, 1 TON = 500 Stars)"})]})]}),r.jsx(o.E.button,{type:"submit",className:"w-full py-3 bg-accent rounded-lg font-bold text-white",whileHover:{scale:1.02},whileTap:{scale:.98},disabled:h,children:h?"Submitting...":"Submit Ad Campaign"})]})]}),m.length>0&&(0,r.jsxs)("div",{className:"p-6 bg-primary/20 backdrop-blur-lg rounded-xl border border-white/10",children:[r.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Your Ad Campaigns"}),r.jsx(o.E.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",className:"space-y-4",children:m.map(e=>(0,r.jsxs)(o.E.div,{variants:{hidden:{opacity:0,y:20},show:{opacity:1,y:0}},className:"bg-primary/10 rounded-xl p-4 border border-white/5",children:[r.jsx("h3",{className:"font-semibold text-white",children:e.title}),r.jsx("p",{className:"text-sm text-white/60",children:e.description}),(0,r.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,r.jsxs)("p",{className:"text-xs text-white/80",children:["Status: ",e.status]}),(0,r.jsxs)("p",{className:"text-xs text-white/80",children:["Clicks Wanted: ",e.clicks_wanted]}),(0,r.jsxs)("p",{className:"text-xs text-white/80",children:["Clicks Received: ",e.clicks_received]}),r.jsx("p",{className:"text-xs text-accent",children:"Reward: +2,000 Musky (Locked)"})]}),r.jsx("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"mt-2 inline-block px-4 py-1 bg-accent rounded-full text-sm text-white hover:bg-accent/80",children:g(e.type)})]},e.id))})]})]})})}},9006:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>l});let r=(0,s(6843).createProxy)(String.raw`/Users/sauravlamichhane/Downloads/Musky-master/src/app/tasks/marketplace/page.tsx`),{__esModule:a,$$typeof:i}=r,l=r.default}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[1638,8575,8110,7822,9657],()=>s(1408));module.exports=r})();