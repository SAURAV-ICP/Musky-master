(()=>{var e={};e.id=494,e.ids=[494],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},3193:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>m,tree:()=>o});var a=s(482),r=s(9108),i=s(2563),n=s.n(i),l=s(8300),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let o=["",{children:["lucky-spin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,5209)),"/Users/sauravlamichhane/Downloads/Musky-master/src/app/lucky-spin/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1342)),"/Users/sauravlamichhane/Downloads/Musky-master/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],u=["/Users/sauravlamichhane/Downloads/Musky-master/src/app/lucky-spin/page.tsx"],d="/lucky-spin/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/lucky-spin/page",pathname:"/lucky-spin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},4230:(e,t,s)=>{Promise.resolve().then(s.bind(s,1318))},1318:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(5344),r=s(3729),i=s(4573),n=s(8110),l=s(3644),c=s(4212),o=s(4669),u=s(6506);let d=Math.floor(100);function p(){let{user:e,mutate:t}=(0,c.a)(),[s,p]=(0,r.useState)(!1),[m,x]=(0,r.useState)(0),[h,f]=(0,r.useState)(null),[y,b]=(0,r.useState)(null),[j,g]=(0,r.useState)(0),[v,w]=(0,r.useState)(null),[N,_]=(0,r.useState)(!1),[k,P]=(0,r.useState)(1e3);(0,r.useEffect)(()=>{if(console.log("Current user data:",e),e?.spin_energy||(console.log("No spin energy found, attempting to initialize..."),t()),e?.spin_energy&&g(e.spin_energy),e?.last_spin_energy_reset&&!e?.is_admin){let s=()=>{let s=new Date,a=new Date(new Date(e.last_spin_energy_reset).getTime()+432e5);if(s>=a){w(null),t();return}let r=a.getTime()-s.getTime();w(`${Math.floor(r/36e5)}h ${Math.floor(r%36e5/6e4)}m`)};s();let a=setInterval(s,6e4);return()=>clearInterval(a)}},[e]);let S=[{type:"SOL",amount:1,chance:"0.1%",color:"#00ff00",emoji:"\uD83D\uDC8E"},{type:"SOL",amount:.5,chance:"0.5%",color:"#00cc00",emoji:"\uD83C\uDF1F"},{type:"MUSKY",amount:5e3,chance:"1%",color:"#0099ff",emoji:"\uD83D\uDE80"},{type:"MUSKY",amount:2e3,chance:"3%",color:"#3366ff",emoji:"\uD83D\uDCAB"},{type:"MUSKY",amount:1e3,chance:"5%",color:"#6633ff",emoji:"✨"},{type:"Energy",amount:500,chance:"10%",color:"#9933ff",emoji:"⚡"},{type:"MUSKY",amount:500,chance:"80.4%",color:"#cc33ff",emoji:"\uD83D\uDCB0"}],E=async()=>{if(e?.user_id&&!s)try{p(!0),x(m+(1800+360*Math.random()));let s=await fetch("/api/lucky-spin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e.user_id})}),a=await s.json();if(!s.ok)throw Error(a.error||"Failed to spin");setTimeout(()=>{f(a.prize),p(!1),t()},3e3),a.next_reset&&b(a.next_reset)}catch(e){p(!1),o.ZP.error(e instanceof Error?e.message:"Failed to spin")}};return a.jsx(i.Z,{children:(0,a.jsxs)("div",{className:"min-h-screen p-4 flex flex-col items-center justify-start pt-8 relative",children:[a.jsx(u.default,{href:"/",className:"absolute top-4 right-4",children:a.jsx(n.E.button,{className:"w-10 h-10 rounded-full bg-accent/20 flex items-center justify-center text-xl hover:bg-accent/40",whileHover:{scale:1.1},whileTap:{scale:.9},children:"✕"})}),a.jsx("h1",{className:"text-3xl font-bold text-center mb-8 text-white",children:"Lucky Spin"}),(0,a.jsxs)(n.E.button,{className:"absolute top-4 left-4 px-4 py-2 bg-accent/20 rounded-full flex items-center space-x-2 hover:bg-accent/40",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>_(!0),children:[a.jsx(n.E.span,{animate:{scale:[1,1.2,1],opacity:[1,.8,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"⚡"}),a.jsx("span",{className:"font-semibold",children:e?.spin_energy||0})]}),(0,a.jsxs)("div",{className:"w-full max-w-md mb-8 bg-primary/20 backdrop-blur-lg rounded-xl p-6 border border-white/10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-2 mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx(n.E.span,{className:"text-xl mr-2",animate:{scale:[1,1.2,1],opacity:[1,.8,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"⚡"}),a.jsx("span",{className:"text-sm font-semibold text-white/80",children:"Stamina"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("span",{className:"text-sm font-bold",children:[j,"/",e?.is_admin?"∞":1200]}),!e?.is_admin&&(0,a.jsxs)("div",{className:"text-xs text-white/60",children:["+",d,"/hour"]})]})]}),a.jsx("div",{className:"w-full h-3 bg-black/20 rounded-full overflow-hidden p-0.5",children:a.jsx(n.E.div,{className:"h-full bg-yellow-400 rounded-full relative overflow-hidden",initial:{width:"0%"},animate:{width:e?.is_admin?"100%":`${j/1200*100}%`},transition:{duration:.5},children:a.jsx(n.E.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:1.5,repeat:1/0,ease:"linear"}})})}),v&&!e?.is_admin&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,a.jsxs)("p",{className:"text-sm text-white/60",children:["Next reset in: ",v]}),(0,a.jsxs)("p",{className:"text-sm text-accent",children:["+",d," stamina/hr"]})]})]}),(0,a.jsxs)("div",{className:"relative w-80 h-80 mb-8",children:[a.jsx(n.E.div,{className:"w-full h-full rounded-full border-4 border-accent relative overflow-hidden bg-black/30",style:{transform:`rotate(${m}deg)`},transition:{duration:3,ease:"easeOut"},children:S.map((e,t)=>(0,a.jsxs)("div",{className:"absolute w-full h-full",style:{transform:`rotate(${360*t/S.length}deg)`,transformOrigin:"50% 50%"},children:[a.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-1 h-1/2 origin-bottom",style:{backgroundColor:e.color}}),a.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 text-2xl",children:e.emoji})]},t))}),a.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-4 h-8 bg-accent",style:{clipPath:"polygon(50% 0, 100% 100%, 0 100%)"}})]}),a.jsx(n.E.button,{className:`px-8 py-3 rounded-xl font-bold text-lg mb-8 ${s||j<1e3?"bg-gray-500 cursor-not-allowed":"bg-accent hover:bg-accent/80"}`,whileHover:!s&&j>=1e3?{scale:1.05}:{},whileTap:!s&&j>=1e3?{scale:.95}:{},onClick:E,disabled:s||j<1e3,children:s?"Spinning...":"SPIN"}),(0,a.jsxs)("div",{className:"w-full max-w-md bg-black/20 rounded-xl p-4",children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-white",children:"Prize Pool"}),a.jsx("div",{className:"space-y-2",children:S.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center text-white/80",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{children:e.emoji}),(0,a.jsxs)("span",{children:[e.amount," ",e.type]})]}),a.jsx("span",{className:"text-accent",children:e.chance})]},t))})]}),a.jsx(l.M,{children:h&&!s&&a.jsx(n.E.div,{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>f(null),children:(0,a.jsxs)(n.E.div,{className:"bg-primary p-8 rounded-2xl text-center",initial:{scale:0},animate:{scale:1},exit:{scale:0},onClick:e=>e.stopPropagation(),children:[a.jsx("div",{className:"text-6xl mb-4",children:S.find(e=>e.type.toLowerCase()===h.type&&e.amount===h.amount)?.emoji||"\uD83C\uDF89"}),a.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Congratulations!"}),(0,a.jsxs)("p",{className:"text-lg",children:["You won ",h.amount," ",h.type.toUpperCase(),"!"]}),a.jsx(n.E.button,{className:"mt-4 px-6 py-2 bg-accent rounded-full font-bold",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>f(null),children:"Awesome!"})]})})}),a.jsx(l.M,{children:N&&a.jsx(n.E.div,{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>_(!1),children:(0,a.jsxs)(n.E.div,{className:"bg-primary/90 backdrop-blur-xl rounded-2xl w-full max-w-md p-6",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Purchase Stamina"}),a.jsx("button",{onClick:()=>_(!1),children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm text-white/60 mb-2",children:"Amount (1000-10000)"}),a.jsx("input",{type:"range",min:"1000",max:"10000",step:"1000",value:k,onChange:e=>P(parseInt(e.target.value)),className:"w-full h-2 bg-accent/20 rounded-full appearance-none cursor-pointer"}),(0,a.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,a.jsxs)("span",{children:[k," Stamina"]}),(0,a.jsxs)("span",{children:[Math.floor(k/10)," Stars"]})]})]}),a.jsx(n.E.button,{className:"w-full py-3 bg-accent rounded-xl font-bold",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:async()=>{try{if(!(await fetch("/api/stamina/purchase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e?.user_id,amount:k,cost:Math.floor(k/10)})})).ok)throw Error("Purchase failed");o.ZP.success("Stamina purchased successfully!"),t(),_(!1)}catch(e){o.ZP.error("Failed to purchase stamina")}},children:"Purchase"})]})]})})})]})})}},5209:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>r,default:()=>n});let a=(0,s(6843).createProxy)(String.raw`/Users/sauravlamichhane/Downloads/Musky-master/src/app/lucky-spin/page.tsx`),{__esModule:r,$$typeof:i}=a,n=a.default}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[638,575,139,876],()=>s(3193));module.exports=a})();