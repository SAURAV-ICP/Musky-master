(()=>{var e={};e.id=7494,e.ids=[7494],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},3193:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>m,tree:()=>c});var r=s(482),a=s(9108),n=s(2563),i=s.n(n),l=s(8300),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["lucky-spin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,5209)),"/Users/sauravlamichhane/Downloads/Musky-master/src/app/lucky-spin/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1342)),"/Users/sauravlamichhane/Downloads/Musky-master/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],u=["/Users/sauravlamichhane/Downloads/Musky-master/src/app/lucky-spin/page.tsx"],d="/lucky-spin/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/lucky-spin/page",pathname:"/lucky-spin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},4230:(e,t,s)=>{Promise.resolve().then(s.bind(s,1318))},1318:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(5344),a=s(3729),n=s(4573),i=s(8110),l=s(3644),o=s(4212),c=s(4669),u=s(6506);let d=Math.floor(100);function p(){let{user:e,mutate:t}=(0,o.a)(),[s,p]=(0,a.useState)(!1),[m,x]=(0,a.useState)(0),[h,f]=(0,a.useState)(null),[y,b]=(0,a.useState)(null),[g,j]=(0,a.useState)(0),[v,w]=(0,a.useState)(null),[N,E]=(0,a.useState)(!1),[k,_]=(0,a.useState)(1e3);(0,a.useEffect)(()=>{if(console.log("Current user data:",e),e?.spin_energy||(console.log("No spin energy found, attempting to initialize..."),t()),e?.spin_energy&&j(e.spin_energy),e?.last_spin_energy_reset&&!e?.is_admin){let s=()=>{let s=new Date,r=new Date(new Date(e.last_spin_energy_reset).getTime()+432e5);if(s>=r){w(null),t();return}let a=r.getTime()-s.getTime();w(`${Math.floor(a/36e5)}h ${Math.floor(a%36e5/6e4)}m`)};s();let r=setInterval(s,6e4);return()=>clearInterval(r)}},[e]);let P=[{type:"SOL",amount:1,chance:"0.1%",color:"#00ff00",emoji:"\uD83D\uDC8E"},{type:"SOL",amount:.5,chance:"0.5%",color:"#00cc00",emoji:"\uD83C\uDF1F"},{type:"MUSKY",amount:5e3,chance:"1%",color:"#0099ff",emoji:"\uD83D\uDE80"},{type:"MUSKY",amount:2e3,chance:"3%",color:"#3366ff",emoji:"\uD83D\uDCAB"},{type:"MUSKY",amount:1e3,chance:"5%",color:"#6633ff",emoji:"✨"},{type:"Energy",amount:500,chance:"10%",color:"#9933ff",emoji:"⚡"},{type:"MUSKY",amount:500,chance:"80.4%",color:"#cc33ff",emoji:"\uD83D\uDCB0"}],C=async()=>{if(e?.user_id&&!s)try{p(!0),x(m+(1800+360*Math.random()));let s=await fetch("/api/lucky-spin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e.user_id})}),r=await s.json();if(!s.ok)throw Error(r.error||"Failed to spin");setTimeout(()=>{f(r.prize),p(!1),t()},3e3),r.next_reset&&b(r.next_reset)}catch(e){p(!1),c.ZP.error(e instanceof Error?e.message:"Failed to spin")}};return r.jsx(n.Z,{children:(0,r.jsxs)("div",{className:"min-h-screen p-4 flex flex-col items-center justify-start pt-8 relative",children:[r.jsx(u.default,{href:"/",className:"absolute top-4 right-4",children:r.jsx(i.E.button,{className:"w-10 h-10 rounded-full bg-accent/20 flex items-center justify-center text-xl hover:bg-accent/40",whileHover:{scale:1.1},whileTap:{scale:.9},children:"✕"})}),r.jsx("h1",{className:"text-3xl font-bold text-center mb-8 text-white",children:"Lucky Spin"}),(0,r.jsxs)(i.E.button,{className:"absolute top-4 left-4 px-4 py-2 bg-accent/20 rounded-full flex items-center space-x-2 hover:bg-accent/40",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>E(!0),children:[r.jsx(i.E.span,{animate:{scale:[1,1.2,1],opacity:[1,.8,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"⚡"}),r.jsx("span",{className:"font-semibold",children:e?.spin_energy||0})]}),(0,r.jsxs)("div",{className:"w-full max-w-md mb-8 bg-primary/20 backdrop-blur-lg rounded-xl p-6 border border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-2 mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(i.E.span,{className:"text-xl mr-2",animate:{scale:[1,1.2,1],opacity:[1,.8,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"⚡"}),r.jsx("span",{className:"text-sm font-semibold text-white/80",children:"Stamina"})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("span",{className:"text-sm font-bold",children:[g,"/",e?.is_admin?"∞":1200]}),!e?.is_admin&&(0,r.jsxs)("div",{className:"text-xs text-white/60",children:["+",d,"/hour"]})]})]}),r.jsx("div",{className:"w-full h-3 bg-black/20 rounded-full overflow-hidden p-0.5",children:r.jsx(i.E.div,{className:"h-full bg-yellow-400 rounded-full relative overflow-hidden",initial:{width:"0%"},animate:{width:e?.is_admin?"100%":`${g/1200*100}%`},transition:{duration:.5},children:r.jsx(i.E.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:1.5,repeat:1/0,ease:"linear"}})})}),v&&!e?.is_admin&&(0,r.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,r.jsxs)("p",{className:"text-sm text-white/60",children:["Next reset in: ",v]}),(0,r.jsxs)("p",{className:"text-sm text-accent",children:["+",d," stamina/hr"]})]})]}),(0,r.jsxs)("div",{className:"relative w-80 h-80 mb-8",children:[r.jsx(i.E.div,{className:"w-full h-full rounded-full border-4 border-accent relative overflow-hidden bg-black/30",style:{transform:`rotate(${m}deg)`},transition:{duration:3,ease:"easeOut"},children:P.map((e,t)=>(0,r.jsxs)("div",{className:"absolute w-full h-full",style:{transform:`rotate(${360*t/P.length}deg)`,transformOrigin:"50% 50%"},children:[r.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-1 h-1/2 origin-bottom",style:{backgroundColor:e.color}}),r.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 text-2xl",children:e.emoji})]},t))}),r.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-4 h-8 bg-accent",style:{clipPath:"polygon(50% 0, 100% 100%, 0 100%)"}})]}),r.jsx(i.E.button,{className:`px-8 py-3 rounded-xl font-bold text-lg mb-8 ${s||g<1e3?"bg-gray-500 cursor-not-allowed":"bg-accent hover:bg-accent/80"}`,whileHover:!s&&g>=1e3?{scale:1.05}:{},whileTap:!s&&g>=1e3?{scale:.95}:{},onClick:C,disabled:s||g<1e3,children:s?"Spinning...":"SPIN"}),(0,r.jsxs)("div",{className:"w-full max-w-md bg-black/20 rounded-xl p-4",children:[r.jsx("h2",{className:"text-xl font-bold mb-4 text-white",children:"Prize Pool"}),r.jsx("div",{className:"space-y-2",children:P.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between items-center text-white/80",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{children:e.emoji}),(0,r.jsxs)("span",{children:[e.amount," ",e.type]})]}),r.jsx("span",{className:"text-accent",children:e.chance})]},t))})]}),r.jsx(l.M,{children:h&&!s&&r.jsx(i.E.div,{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>f(null),children:(0,r.jsxs)(i.E.div,{className:"bg-primary p-8 rounded-2xl text-center",initial:{scale:0},animate:{scale:1},exit:{scale:0},onClick:e=>e.stopPropagation(),children:[r.jsx("div",{className:"text-6xl mb-4",children:P.find(e=>e.type.toLowerCase()===h.type&&e.amount===h.amount)?.emoji||"\uD83C\uDF89"}),r.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Congratulations!"}),(0,r.jsxs)("p",{className:"text-lg",children:["You won ",h.amount," ",h.type.toUpperCase(),"!"]}),r.jsx(i.E.button,{className:"mt-4 px-6 py-2 bg-accent rounded-full font-bold",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>f(null),children:"Awesome!"})]})})}),r.jsx(l.M,{children:N&&r.jsx(i.E.div,{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>E(!1),children:(0,r.jsxs)(i.E.div,{className:"bg-primary/90 backdrop-blur-xl rounded-2xl w-full max-w-md p-6",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Purchase Stamina"}),r.jsx("button",{onClick:()=>E(!1),children:"✕"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm text-white/60 mb-2",children:"Amount (1000-10000)"}),r.jsx("input",{type:"range",min:"1000",max:"10000",step:"1000",value:k,onChange:e=>_(parseInt(e.target.value)),className:"w-full h-2 bg-accent/20 rounded-full appearance-none cursor-pointer"}),(0,r.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,r.jsxs)("span",{children:[k," Stamina"]}),(0,r.jsxs)("span",{children:[Math.floor(k/10)," Stars"]})]})]}),r.jsx(i.E.button,{className:"w-full py-3 bg-accent rounded-xl font-bold",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:async()=>{try{if(!(await fetch("/api/stamina/purchase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e?.user_id,amount:k,cost:Math.floor(k/10)})})).ok)throw Error("Purchase failed");c.ZP.success("Stamina purchased successfully!"),t(),E(!1)}catch(e){c.ZP.error("Failed to purchase stamina")}},children:"Purchase"})]})]})})})]})})}},5209:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>i});let r=(0,s(6843).createProxy)(String.raw`/Users/sauravlamichhane/Downloads/Musky-master/src/app/lucky-spin/page.tsx`),{__esModule:a,$$typeof:n}=r,i=r.default},3644:(e,t,s)=>{"use strict";s.d(t,{M:()=>f});var r=s(3729),a=s(9038);function n(){let e=(0,r.useRef)(!1);return(0,a.L)(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var i=s(1475),l=s(5986),o=s(207);class c extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function u({children:e,isPresent:t}){let s=(0,r.useId)(),a=(0,r.useRef)(null),n=(0,r.useRef)({width:0,height:0,top:0,left:0});return(0,r.useInsertionEffect)(()=>{let{width:e,height:r,top:i,left:l}=n.current;if(t||!a.current||!e||!r)return;a.current.dataset.motionPopId=s;let o=document.createElement("style");return document.head.appendChild(o),o.sheet&&o.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${r}px !important;
            top: ${i}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(o)}},[t]),r.createElement(c,{isPresent:t,childRef:a,sizeRef:n},r.cloneElement(e,{ref:a}))}let d=({children:e,initial:t,isPresent:s,onExitComplete:a,custom:n,presenceAffectsLayout:i,mode:c})=>{let d=(0,o.h)(p),m=(0,r.useId)(),x=(0,r.useMemo)(()=>({id:m,initial:t,isPresent:s,custom:n,onExitComplete:e=>{for(let t of(d.set(e,!0),d.values()))if(!t)return;a&&a()},register:e=>(d.set(e,!1),()=>d.delete(e))}),i?void 0:[s]);return(0,r.useMemo)(()=>{d.forEach((e,t)=>d.set(t,!1))},[s]),r.useEffect(()=>{s||d.size||!a||a()},[s]),"popLayout"===c&&(e=r.createElement(u,{isPresent:s},e)),r.createElement(l.O.Provider,{value:x},e)};function p(){return new Map}var m=s(6828),x=s(7222);let h=e=>e.key||"",f=({children:e,custom:t,initial:s=!0,onExitComplete:l,exitBeforeEnter:o,presenceAffectsLayout:c=!0,mode:u="sync"})=>{var p;(0,x.k)(!o,"Replace exitBeforeEnter with mode='wait'");let f=(0,r.useContext)(m.p).forceRender||function(){let e=n(),[t,s]=(0,r.useState)(0),a=(0,r.useCallback)(()=>{e.current&&s(t+1)},[t]);return[(0,r.useCallback)(()=>i.Wi.postRender(a),[a]),t]}()[0],y=n(),b=function(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}(e),g=b,j=(0,r.useRef)(new Map).current,v=(0,r.useRef)(g),w=(0,r.useRef)(new Map).current,N=(0,r.useRef)(!0);if((0,a.L)(()=>{N.current=!1,function(e,t){e.forEach(e=>{let s=h(e);t.set(s,e)})}(b,w),v.current=g}),p=()=>{N.current=!0,w.clear(),j.clear()},(0,r.useEffect)(()=>()=>p(),[]),N.current)return r.createElement(r.Fragment,null,g.map(e=>r.createElement(d,{key:h(e),isPresent:!0,initial:!!s&&void 0,presenceAffectsLayout:c,mode:u},e)));g=[...g];let E=v.current.map(h),k=b.map(h),_=E.length;for(let e=0;e<_;e++){let t=E[e];-1!==k.indexOf(t)||j.has(t)||j.set(t,void 0)}return"wait"===u&&j.size&&(g=[]),j.forEach((e,s)=>{if(-1!==k.indexOf(s))return;let a=w.get(s);if(!a)return;let n=E.indexOf(s),i=e;i||(i=r.createElement(d,{key:h(a),isPresent:!1,onExitComplete:()=>{j.delete(s);let e=Array.from(w.keys()).filter(e=>!k.includes(e));if(e.forEach(e=>w.delete(e)),v.current=b.filter(t=>{let r=h(t);return r===s||e.includes(r)}),!j.size){if(!1===y.current)return;f(),l&&l()}},custom:t,presenceAffectsLayout:c,mode:u},a),j.set(s,i)),g.splice(n,0,i)}),g=g.map(e=>{let t=e.key;return j.has(t)?e:r.createElement(d,{key:h(e),isPresent:!0,presenceAffectsLayout:c,mode:u},e)}),r.createElement(r.Fragment,null,j.size?g:g.map(e=>(0,r.cloneElement)(e)))}}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[1638,8575,8110,7822,9657],()=>s(3193));module.exports=r})();